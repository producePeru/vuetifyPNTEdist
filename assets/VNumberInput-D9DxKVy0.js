import{v as ce,S as se,R as de,r as ve,aM as fe,k as P,s as Y,a3 as me,T as pe,az as _,au as ge,h as R,p as Z,o as be,an as we,D as J,d as w,e as m,F as A,G as Ne,I as Q,a5 as W,aq as he,ar as De,aN as Pe,K as xe,aO as Ve,aP as Ie}from"./index-CmTDUpRJ.js";import{f as B}from"./VSnackbar-CCN-NJch.js";const Se=50,Fe=500;function Ee(n){let{toggleUpDown:M}=n,u=-1,b=-1;ce(d);function F(l){d(),x(l),window.addEventListener("pointerup",d),document.addEventListener("blur",d),u=window.setTimeout(()=>{b=window.setInterval(()=>x(l),Se)},Fe)}function d(){window.clearTimeout(u),window.clearInterval(b),window.removeEventListener("pointerup",d),document.removeEventListener("blur",d)}function x(l){M(l==="up")}return{holdStart:F,holdStop:d}}const ye=de({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},minFractionDigits:{type:Number,default:null},decimalSeparator:{type:String,validator:n=>!n||n.length===1},...De(Pe(),["modelValue","validationValue"])},"VNumberInput"),Ce=se()({name:"VNumberInput",props:{...ye()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,M){let{slots:u}=M;const b=ve(),{holdStart:F,holdStop:d}=Ee({toggleUpDown:z}),x=fe(n),l=P(()=>x.isDisabled.value||x.isReadonly.value),E=Y(n.focused),{decimalSeparator:ee}=me(),c=P(()=>{var e;return((e=n.decimalSeparator)==null?void 0:e[0])||ee.value});function N(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const g=t==null?String(e):e.toFixed(t);if(E.value&&r)return Number(g).toString().replace(".",c.value);if(n.minFractionDigits===null||t!==null&&t<n.minFractionDigits)return g.replace(".",c.value);let[h,o]=g.split(".");return o=(o??"").padEnd(n.minFractionDigits,"0").replace(new RegExp(`(?<=\\d{${n.minFractionDigits}})0`,"g"),""),[h,o].filter(Boolean).join(c.value)}const a=pe(n,"modelValue",null,e=>e??null,e=>e==null?e??null:_(Number(e),n.min,n.max)),V=Y(null);ge(()=>{E.value&&!l.value||(a.value==null?V.value=null:isNaN(a.value)||(V.value=N(a.value)))});const s=P({get:()=>V.value,set(e){if(e===null||e===""){a.value=null,V.value=null;return}const t=Number(e.replace(c.value,"."));!isNaN(t)&&t<=n.max&&t>=n.min&&(a.value=t,V.value=e)}}),L=P(()=>l.value?!1:(a.value??0)+n.step<=n.max),$=P(()=>l.value?!1:(a.value??0)-n.step>=n.min),i=P(()=>n.hideInput?"stacked":n.controlVariant),H=R(()=>i.value==="split"?"$plus":"$collapse"),K=R(()=>i.value==="split"?"$minus":"$expand"),y=R(()=>i.value==="split"?"default":"small"),T=R(()=>i.value==="stacked"?"auto":"100%"),ne={props:{onClick:k,onPointerup:p,onPointerdown:G,onPointercancel:p}},te={props:{onClick:k,onPointerup:p,onPointerdown:j,onPointercancel:p}};Z(()=>n.precision,()=>q()),Z(()=>n.minFractionDigits,()=>q()),be(()=>{U()});function O(e){if(e==null)return 0;const t=e.toString(),r=t.indexOf(".");return~r?t.length-r:0}function z(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(l.value)return;if(a.value==null){s.value=N(_(0,n.min,n.max));return}let t=Math.max(O(a.value),O(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?L.value&&(s.value=N(a.value+n.step,t)):$.value&&(s.value=N(a.value-n.step,t))}function ae(e){var C;if(!e.data)return;const t=e.target,{value:r,selectionStart:g,selectionEnd:h}=t??{},o=r?r.slice(0,g)+e.data+r.slice(h):e.data,D=Ve(o,n.precision,c.value);new RegExp(`^-?\\d*${Ie(c.value)}?\\d*$`).test(o)||(e.preventDefault(),t.value=D),n.precision!=null&&(((C=o.split(c.value)[1])==null?void 0:C.length)>n.precision&&(e.preventDefault(),t.value=D),n.precision===0&&o.includes(c.value)&&(e.preventDefault(),t.value=D))}async function ue(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),U(),await xe(),e.key==="ArrowDown"?z(!1):z())}function k(e){e.stopPropagation()}function p(e){const t=e.currentTarget;t==null||t.releasePointerCapture(e.pointerId),e.preventDefault(),d()}function G(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),F("up")}function j(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),F("down")}function U(){if(l.value||!b.value)return;const e=b.value.value,t=Number(e.replace(c.value,"."));e&&!isNaN(t)?s.value=N(_(t,n.min,n.max)):s.value=null}function q(){l.value||(s.value=a.value!==null&&!isNaN(a.value)?N(a.value,n.precision,!1):null)}function le(){if(!l.value){if(a.value===null||isNaN(a.value)){s.value=null;return}s.value=a.value.toString().replace(".",c.value)}}function ie(){le()}function re(){U()}return we(()=>{const{modelValue:e,...t}=J.filterProps(n);function r(){return u.increment?m(W,{key:"increment-defaults",defaults:{VBtn:{disabled:!L.value,flat:!0,height:T.value,size:y.value,icon:H.value}}},{default:()=>[u.increment(ne)]}):m(Q,{"aria-hidden":"true","data-testid":"increment",disabled:!L.value,flat:!0,height:T.value,icon:H.value,key:"increment-btn",onClick:k,onPointerdown:G,onPointerup:p,onPointercancel:p,size:y.value,tabindex:"-1"},null)}function g(){return u.decrement?m(W,{key:"decrement-defaults",defaults:{VBtn:{disabled:!$.value,flat:!0,height:T.value,size:y.value,icon:K.value}}},{default:()=>[u.decrement(te)]}):m(Q,{"aria-hidden":"true","data-testid":"decrement",disabled:!$.value,flat:!0,height:T.value,icon:K.value,key:"decrement-btn",onClick:k,onPointerdown:j,onPointerup:p,onPointercancel:p,size:y.value,tabindex:"-1"},null)}function h(){return w("div",{class:"v-number-input__control"},[g(),m(B,{vertical:i.value!=="stacked"},null),r()])}function o(){return!n.hideInput&&!n.inset?m(B,{vertical:!0},null):void 0}const D=i.value==="split"?w("div",{class:"v-number-input__control"},[m(B,{vertical:!0},null),r()]):n.reverse||i.value==="hidden"?void 0:w(A,null,[o(),h()]),C=u["append-inner"]||D,X=i.value==="split"?w("div",{class:"v-number-input__control"},[g(),m(B,{vertical:!0},null)]):n.reverse&&i.value!=="hidden"?w(A,null,[h(),o()]):void 0,oe=u["prepend-inner"]||X;return m(J,Ne({ref:b},t,{modelValue:s.value,"onUpdate:modelValue":v=>s.value=v,focused:E.value,"onUpdate:focused":v=>E.value=v,validationValue:a.value,onBeforeinput:ae,onFocus:ie,onBlur:re,onKeydown:ue,class:["v-number-input",{"v-number-input--default":i.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":i.value==="split","v-number-input--stacked":i.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...u,"append-inner":C?function(){var S;for(var v=arguments.length,I=new Array(v),f=0;f<v;f++)I[f]=arguments[f];return w(A,null,[(S=u["append-inner"])==null?void 0:S.call(u,...I),D])}:void 0,"prepend-inner":oe?function(){var S;for(var v=arguments.length,I=new Array(v),f=0;f<v;f++)I[f]=arguments[f];return w(A,null,[X,(S=u["prepend-inner"])==null?void 0:S.call(u,...I)])}:void 0})}),he({},b)}});export{Ce as V};
