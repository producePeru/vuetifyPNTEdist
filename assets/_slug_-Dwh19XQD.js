import{r as n,c as p,b as l,e as t,w as a,d as o,n as ue,t as v,g as c,V as D,_ as ie,s as z,u as ce,h as de,i as H,o as me,f as E,j as fe,F as pe,k as ve,l as Y,m as k,p as ge,q as I,v as ye,x as _e,y as F,z as Ve,A as Q}from"./index-3ZS4mmbk.js";import{_ as we}from"./sed-robot-BghC5CVp.js";import{u as xe}from"./usePageMeta-DJqFmFkG.js";import{h as $}from"./httpRequest-D3KC4pOG.js";import{d as O,V as L}from"./VDialog-DSVGdQAF.js";import"./es-BMal9jmf.js";import{V as M,a as U}from"./VRow-BUCwKPdE.js";import{V as be}from"./VAvatar-CniIBmDG.js";import{_ as he}from"./EventFinalized-C5z_DEgc.js";import{u as Ce,a as Ee,b as ke,c as De,H as $e}from"./useDynamicManifest-WZejVuHv.js";import{u as Se,c as S,m as Te,r as Ne}from"./index-BBnWEKBt.js";import{V as R}from"./VContainer-_thcESsg.js";import{V as Ae}from"./VTooltip-BgR-Ormb.js";import{V as G,a as Ie,b as J,c as K}from"./VCard-CYTY4Ak6.js";/* empty css                                                       */const Me="/assets/logo-sed-Bdpizhaz.png",Re={style:{"line-height":"2"}},je={style:{"list-style":"none","padding-left":"0"}},qe={__name:"DetalleAsistencia",props:{color:String,title:String,eventType:String,info:Object,modal:Boolean},setup(V){O.locale("es");const m=h=>h?O(h).format("DD/MM/YYYY"):"";return n(!0),(h,u)=>(l(),p("section",null,[t(U,{justify:"center",align:"center",class:"h-100"},{default:a(()=>[t(M,{cols:"auto"},{default:a(()=>[t(be,{width:200,src:Me})]),_:1})]),_:1}),t(U,null,{default:a(()=>[t(M,{cols:"12",class:"text-center"},{default:a(()=>{var g;return[o("h1",{class:"title",style:ue({color:V.color})},v((g=V.info)==null?void 0:g.title),5)]}),_:1}),t(M,null,{default:a(()=>{var g,y,d;return[o("div",Re,[u[3]||(u[3]=o("h4",null,"Información",-1)),o("ul",je,[o("li",null,[t(D,null,{default:a(()=>u[0]||(u[0]=[c("mdi-map-marker")])),_:1,__:[0]}),c(" LUGAR: "+v((g=V.info)==null?void 0:g.place),1)]),o("li",null,[t(D,{left:""},{default:a(()=>u[1]||(u[1]=[c("mdi-calendar")])),_:1,__:[1]}),c(" FECHA: "+v(m((y=V.info)==null?void 0:y.fecha)),1)]),o("li",null,[t(D,{left:""},{default:a(()=>u[2]||(u[2]=[c("mdi-clock-time-four-outline")])),_:1,__:[2]}),c(" HORARIO: "+v((d=V.info)==null?void 0:d.schedule),1)])])])]}),_:1})]),_:1})]))}},Be={class:"pp03-background"},Pe={class:"container-asistance"},ze={class:"my-10"},He={key:0,class:"text-center d-flex align-center justify-center"},Ye={key:0,class:"qr-modal-user"},Fe={class:"mt-3"},Qe={key:1,class:"qr-modal-user"},Oe=["src"],Le={key:2,class:"qr-modal-user"},Ue={__name:"[slug]",setup(V){xe("SED | Sesión de Entrenamiento Digital","Registrar asistencia al SED","sed-pnte.ico");const m=ce(),h=ve(),u=z(`https://inscripcion.soporte-pnte.com/sed/${m.params.slug}`),g=Ce(u,{errorCorrectionLevel:"H",margin:3}),y=n(null),d=n(!1),W=n(null),w=n(null),T=n(null),C=n(!1),X=z(""),j=n(null),x=n(!1);n(!1);const q=n(!1),B=n("#02E4A5"),N=de(()=>!!i.documentnumber&&f.value.documentnumber.$dirty&&!f.value.documentnumber.$invalid),b=n(!1);let _=null;const Z=async()=>{b.value=!0,await Q(),ee()},ee=async()=>{try{if(d.value=!0,_&&await A(),!document.getElementById("reader")){console.warn("Elemento reader no encontrado"),d.value=!1;return}_=new $e("reader"),await _.start({facingMode:"environment"},{fps:10,qrbox:250},e=>{i.documentnumber=e,f.value.$touch(),b.value=!1,A()},e=>{})}catch(r){console.error("No se pudo iniciar el escáner:",r),alert("No se pudo acceder a la cámara. Verifica los permisos del navegador."),b.value=!1}finally{d.value=!1}},A=async()=>{try{d.value=!0,_&&(await _.stop().catch(()=>{}),await _.clear(),_=null)}catch(r){console.error("Error al detener el escáner:",r)}finally{d.value=!1}},te=H({documentnumber:null}),i=H({...te}),ae=S.withMessage("Corrige el número de documento",S.regex(/^\d+$/)),se={documentnumber:{required:S.withMessage("Ingresar número de documento",Ne),minLength:S.withMessage("Completa el número de identidad",Te(8)),validDni:ae}},re=async()=>{var e,s;C.value=!1,X.value="",T.value=null,await Q();const r=(s=(e=W.value)==null?void 0:e.$el)==null?void 0:s.querySelector("input");r&&r.focus()},oe=async()=>{try{const r={slug:m.params.slug,dni:i.documentnumber},e=await $({url:"public/participant-info",method:"POST",data:r});if(e.status==200)return T.value=e,await ne(e.doc);w.value="no-se-registro",i.documentnumber=null,f.value.$reset(),C.value=!0}catch{console.error("Error ejecutando reCAPTCHA:",error)}},ne=async r=>{try{const e={dni:r,slug:m.params.slug,attended:ke(De(),"DD/MM/YYYY HH:mm a").value},s=await $({url:"public/register-attendance",method:"PUT",data:e});if(C.value=!0,s.status==200)return i.documentnumber=null,f.value.$reset(),P(),w.value="asistio";w.value="ya-estas-registrado",i.documentnumber=null,f.value.$reset()}catch{console.error("Error ejecutando reCAPTCHA:",error)}},le=async()=>{try{x.value=!0;const r=m.params.slug,e=await $({url:`public/event-sed-details/${r}`,method:"GET"});if(e.status==400)return h.replace("/pagina-no-encontrada");if(e.status==404)return q.value=!0;const s=e.data;j.value=s,e.status==200&&(i.slug=s.slug,x.value=!1)}catch(r){console.error("Error de red:",r)}finally{x.value=!1}},P=async()=>{try{const r=m.params.slug,e=await $({url:`public/data-event-count/${r}`,method:"GET"});e.status==200&&(y.value=e.data)}catch(r){console.error("Error de red:",r)}finally{x.value=!1}},f=Se(se,i);return me(async()=>{await le(),await P(),Ee("SED | 2025",m.params.slug)}),(r,e)=>(l(),p("section",Be,[o("div",Pe,[t(fe,{"model-value":x.value,class:"align-center justify-center",persistent:"",scrim:""},{default:a(()=>[t(Y,{color:"primary",size:"64",indeterminate:""})]),_:1},8,["model-value"]),q.value?(l(),E(R,{key:0,class:"pp03-container"},{default:a(()=>[t(he)]),_:1})):(l(),p(pe,{key:1},[x.value?(l(),E(R,{key:0,class:"pp03-container"})):(l(),E(R,{key:1,class:"pp03-container"},{default:a(()=>[t(qe,{color:B.value,info:j.value,title:"SESIÓN DE ENTRETANIENTO DIGITAL",eventType:"sed"},null,8,["color","info"]),o("div",ze,[t(ge,{class:"input-search-dni",color:B.value,modelValue:i.documentnumber,"onUpdate:modelValue":e[1]||(e[1]=s=>i.documentnumber=s),counter:11,maxlength:11,"error-messages":I(f).documentnumber.$errors.map(s=>s.$message),label:"Número de documento",density:"comfortable",variant:"outlined",onInput:I(f).documentnumber.$touch},{"append-inner":a(()=>[t(Ae,{text:N.value?"Buscar por DNI":"Escanear DNI",location:"top"},{activator:a(({props:s})=>[d.value?(l(),E(Y,{key:0,indeterminate:"",color:"primary",size:"20",class:"me-2"})):(l(),E(D,ye({key:1},s,{class:"me-2 btn-input-search",onClick:e[0]||(e[0]=_e(Ge=>N.value?oe():Z(),["stop"]))}),{default:a(()=>[c(v(N.value?"mdi-magnify":"mdi-qrcode-scan"),1)]),_:2},1040))]),_:1},8,["text"])]),_:1},8,["color","modelValue","error-messages","onInput"]),t(L,{modelValue:b.value,"onUpdate:modelValue":[e[3]||(e[3]=s=>b.value=s),e[4]||(e[4]=s=>{s||A()})],fullscreen:"",transition:"dialog-bottom-transition",persistent:""},{default:a(()=>[t(G,{class:"d-flex flex-column align-center justify-center",style:{"background-color":"#000"}},{default:a(()=>[t(Ie,{class:"text-white text-h6 text-center mt-4"},{default:a(()=>e[6]||(e[6]=[c("Escanear código")])),_:1,__:[6]}),t(J,{class:"d-flex justify-center"},{default:a(()=>e[7]||(e[7]=[o("div",{id:"reader",style:{width:"90vw","max-width":"400px"}},null,-1)])),_:1,__:[7]}),t(K,{class:"justify-center mt-4"},{default:a(()=>[t(F,{color:"red",variant:"flat",onClick:e[2]||(e[2]=s=>b.value=!1)},{default:a(()=>e[8]||(e[8]=[c(" Cancelar ")])),_:1,__:[8]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),y.value?(l(),p("div",He,[t(D,{size:"18",class:"mr-1",color:"grey darken-1"},{default:a(()=>e[9]||(e[9]=[c("mdi-pound")])),_:1,__:[9]}),o("h2",null,v(y.value.amountNow)+" / "+v(y.value.total),1)])):k("",!0)]),_:1}))],64))]),t(L,{modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=s=>C.value=s),"max-width":"500",persistent:""},{default:a(()=>[t(G,null,{default:a(()=>[t(J,null,{default:a(()=>{var s;return[w.value=="asistio"?(l(),p("div",Ye,[e[10]||(e[10]=o("p",null,"¡Bienvenido al evento!",-1)),o("h2",Fe,v((s=T.value)==null?void 0:s.name),1),e[11]||(e[11]=o("img",{src:we,width:"120"},null,-1)),e[12]||(e[12]=o("p",{style:{"font-size":"14px",color:"#777","margin-top":"10px"}}," Nos alegra contar con tu presencia. Prepárate para una experiencia única llena de aprendizaje, inspiración y conexión. ",-1))])):k("",!0),w.value=="no-se-registro"?(l(),p("div",Qe,[e[13]||(e[13]=o("p",null,"No estas registrado",-1)),e[14]||(e[14]=o("h2",{class:"mt-3"},"Escanea el código QR para registrarte",-1)),u.value?(l(),p("img",{key:0,class:"mt-6 mb-2 rounded border",src:I(g),alt:"QR Code"},null,8,Oe)):k("",!0)])):k("",!0),w.value=="ya-estas-registrado"?(l(),p("div",Le,e[15]||(e[15]=[o("h2",{class:"mt-3"},"Ya has sido registrado",-1)]))):k("",!0)]}),_:1}),t(K,null,{default:a(()=>[t(Ve),t(F,{text:"Cerrar",onClick:re})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},ct=ie(Ue,[["__scopeId","data-v-91b90e02"]]);export{ct as default};
