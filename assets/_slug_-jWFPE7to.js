import{u as q}from"./usePageMeta-B5PQnnIL.js";import{h as w}from"./httpRequest-D3KC4pOG.js";import{B as z,F as O}from"./Finalizado-VnobeRFY.js";import{_ as I}from"./FormComponent-BryQzfPv.js";import{u as G}from"./useFormOptions-BD_ZbAMu.js";import{r as u,L as H,i as E,u as P,k as U,H as Y,o as T,c as h,b as r,e as s,w as i,d,V as j,g as p,M as S,f as C,m as $,y as J,_ as K,j as Q,l as W}from"./index-D28FsBV0.js";import"./VDialog-CZVTqr-9.js";import{V as X}from"./VSnackbar-BO5cPS8E.js";import{V as Z}from"./VContainer-ESEv3mXL.js";import{a as ee,V as te}from"./VRow-D9Ayz5-L.js";import{V as ae}from"./VCard-B0b5dldY.js";import"./mp-D70lmokk.js";import"./es-C8Y6Ksty.js";import"./VAvatar-B6WWvOvg.js";import"./index-BmNUNIB9.js";import"./VForm-eZQ0dekN.js";import"./VList-BV4FJzHM.js";const oe={class:"mp-form-link-sala"},se={class:"d-flex align-center"},le={__name:"MujerProduceFormLinkSala",emits:["goLink"],setup(y,{emit:v}){const g=v,l=u(!1),m=H(),e=u(!1),_=E({}),f=P(),x=U(),t=u(!1);u(1);const a=E({});S("formState",a),S("loadingStates",_),S("loadingSubmit",t);const b=E([{type:"title",label:"Datos del Participante",md:12},{type:"select",label:"Tipo de documento",model:"typedocument_id",required:!0,options:[]},{type:"search",label:"Número de Documento",model:"documentnumber",required:!0,max:8,disabled:!1}]);Y(e,n=>{m.global.name.value=n?"dark":"light"});const A=n=>{},D=async(n,o)=>{if(n.model==="typedocument_id"){const c=b.find(V=>V.model==="documentnumber");if(!c)return;const k={1:{max:8,autolockNames:!0},2:{max:9,autolockNames:!1},3:{max:12,autolockNames:!1},default:{max:9,autolockNames:!1}},N=k[n.value]||k.default;c.max=N.max,["name","lastname","middlename"].forEach(V=>{const F=b.find(R=>R.model===V);F&&(F.disabled=N.autolockNames)}),c.disabled=!1}if(n.model==="documentnumber"){const c=b.find(k=>k.model==="documentnumber");c&&(c.disabled=!1)}},B=async n=>{},L=async()=>{t.value=!0;const n={doc_number:a.documentnumber,slug:f.params.slug};try{const o=await w({url:"mp/sala-link-meet",method:"POST",data:n});o.status==401&&l("Esta capacitación es presencial, por lo que no dispone de enlace de sala virtual."),o.status==403&&(l.value=!0,setTimeout(()=>{x.push(`/mujer-produce/${f.params.slug}`)},2500)),o.status==200&&g("goLink",a)}catch(o){console.log("Error: ",o)}finally{t.value=!1}},{loadTypeDocuments:M}=G(b);return T(async()=>{await M()}),(n,o)=>(r(),h("div",oe,[s(I,{colorForm:"#7d4fc6",fields:b,onSearchDataApi:B,onSubmit:L,onChange:D,onHandleClearSearch:A},null,8,["fields"]),s(X,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=c=>l.value=c),color:"#ff4d4f"},{default:i(()=>[d("div",se,[s(j,{class:"me-3"},{default:i(()=>o[1]||(o[1]=[p("mdi-alert-circle-outline")])),_:1,__:[1]}),o[2]||(o[2]=d("span",null," Parece que no te has registrado. Completa tu inscripción en el siguiente formulario. ",-1))])]),_:1},8,["modelValue"])]))}},ne={class:"d-flex justify-center align-center"},re={class:"text-center pa-8",style:{"max-width":"420px",width:"100%"}},ie={__name:"Acceso",props:{detailEvent:{type:Object,default:()=>({})}},emits:["handleAttendance"],setup(y,{emit:v}){const g=v,l=async()=>{g("handleAttendance",!0)};return(m,e)=>{var _,f;return r(),h("div",ne,[d("div",re,[s(j,{size:"64",color:"#7d4fc6",class:"mb-4"},{default:i(()=>e[0]||(e[0]=[p(" mdi-video-check-outline ")])),_:1,__:[0]}),e[2]||(e[2]=d("h2",{class:"text-h5 font-weight-semibold mb-2"}," Acceso habilitado ",-1)),e[3]||(e[3]=d("p",{class:"text-body-1 text-medium-emphasis mb-6"},[p(" Tu registro fue validado correctamente."),d("br"),p(" Ya puedes acceder a la sala virtual desde el siguiente enlace. ")],-1)),(_=y.detailEvent)!=null&&_.link?(r(),C(J,{key:0,color:"#7d4fc6",size:"large",rounded:"pill",class:"text-none font-weight-medium mb-3",block:"","prepend-icon":"mdi-video",href:(f=y.detailEvent)==null?void 0:f.link,target:"_blank",onClick:l},{default:i(()=>e[1]||(e[1]=[p(" Ingresar a la sala virtual ")])),_:1,__:[1]},8,["href"])):$("",!0),e[4]||(e[4]=d("p",{class:"text-caption text-medium-emphasis"}," Recomendamos ingresar con unos minutos de anticipación. ",-1))])])}}},de={key:0,class:"mp",style:{"min-height":"calc(100vh - 390px)"}},ce={key:0},ue={key:1,class:"text-center"},me={key:1},fe={__name:"[slug]",setup(y){q("Mujer Produce | Registro","Formulario de registro para el Evento de Producción de Mujeres","mp-ico.ico");const v=u(!0),g=P(),l=u(!0),m=u({}),e=u(null),_=t=>{t.documentnumber&&(e.value=t.documentnumber,v.value=!1)},f=async()=>{try{const t=g.params.slug,a=await w({url:`mp/info-event-public/${t}`,method:"GET"});a.status===200&&(m.value=(a==null?void 0:a.data)||{}),console.log("response",a)}catch(t){console.error("Error de red:",t)}finally{l.value=!1}},x=async()=>{try{const t={slug:g.params.slug,doc_number:e.value},a=await w({url:"mp/attendance-participant",method:"POST",data:t});console.log("response",a)}catch(t){console.error("Error de red:",t)}};return T(async()=>{await f()}),(t,a)=>(r(),C(Z,{class:"py-0",fluid:""},{default:i(()=>[s(ee,{align:"center",justify:"center"},{default:i(()=>[s(te,{cols:"12",sm:"12",md:"10",lg:"8",xl:"6",class:"my-2"},{default:i(()=>[s(Q,{"model-value":l.value,class:"align-center justify-center",persistent:"",scrim:""},{default:i(()=>[s(W,{color:"#7d4fc6",size:"64",indeterminate:""})]),_:1},8,["model-value"]),l.value?$("",!0):(r(),C(ae,{key:0,elevation:"8",rounded:"lg"},{default:i(()=>[s(z,{detailEvent:m.value},null,8,["detailEvent"]),m.value.finished?(r(),h("div",me,[s(O)])):(r(),h("div",de,[v.value?(r(),h("div",ce,[a[0]||(a[0]=d("p",{class:"mb-6",style:{color:"#7d4fc6"}},[p(" Para ingresar a la sesión, primero debes registrar tu número de DNI."),d("br"),p(" Una vez validado, se habilitará el enlace de la sala virtual. ")],-1)),s(le,{onGoLink:_})])):(r(),h("div",ue,[s(ie,{detailEvent:m.value,onHandleAttendance:x},null,8,["detailEvent"])]))]))]),_:1}))]),_:1})]),_:1})]),_:1}))}},Te=K(fe,[["__scopeId","data-v-0ce7b519"]]);export{Te as default};
