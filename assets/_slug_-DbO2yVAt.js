import{u as ae}from"./usePageMeta-CQWQEsFO.js";import{d as w}from"./VDialog-CcHf3q6Q.js";import{c as oe}from"./customParseFormat-CkN1yU46.js";import"./es-CwGK4w58.js";import{_ as le,c as T,b as N,e as l,w as s,d as v,t as h,g as p,V as x,r as y,u as de,h as C,i as z,j as re,o as O,k as ne,p as D,f as $,l as se,m as ce,n as me}from"./index-DdXFwoKA.js";import{V as P,a as F}from"./VRow-BQlREuyd.js";import{_ as ue}from"./FormComponent-ekcJtzLF.js";import{u as _e}from"./useFormOptions-BD_ZbAMu.js";import{h as g}from"./httpRequest-D3KC4pOG.js";import{V as fe}from"./VSnackbar-BzIHievQ.js";import{V as pe}from"./VContainer-BZ1L2Djm.js";import{V as ye}from"./VCard-binWRFly.js";import"./index-LRRaG21R.js";import"./VForm-2bzjEkWU.js";import"./VList-Cbk_1-07.js";import"./VAvatar-BN75WEmc.js";const be={class:"mp-header mp"},ve={style:{"line-height":"2.2",color:"#fff",position:"relative","z-index":"2"}},he={class:"mp-title"},ge={style:{"list-style":"none","padding-left":"0","font-size":"18px"}},Se={class:"mp-list"},Ee={class:"mp-list"},xe={class:"mp-list"},we={__name:"ActividadesUgo",props:{detailEvent:{type:Object,default:()=>({})}},setup(u){w.extend(oe);const m=_=>_?w(_,["HH:mm:ss","HH:mm"]).format("hh:mm A"):"";return(_,c)=>(N(),T("div",be,[l(F,null,{default:s(()=>[l(P,null,{default:s(()=>[v("div",ve,[v("h1",he,h(u.detailEvent.title),1),v("ul",ge,[v("li",Se,[l(x,null,{default:s(()=>c[0]||(c[0]=[p("mdi-tag")])),_:1,__:[0]}),p(" TEMA: "+h(u.detailEvent.theme),1)]),v("li",Ee,[l(x,{left:""},{default:s(()=>c[1]||(c[1]=[p("mdi-calendar")])),_:1,__:[1]}),p(" FECHA: "+h(u.detailEvent.startDate)+" - "+h(u.detailEvent.endDate),1)]),v("li",xe,[l(x,{left:""},{default:s(()=>c[2]||(c[2]=[p("mdi-clock-time-four-outline")])),_:1,__:[2]}),p(" HORARIO: "+h(m(u.detailEvent.startDate))+" – "+h(m(u.detailEvent.endDate)),1)])])])]),_:1})]),_:1})]))}},Ne=le(we,[["__scopeId","data-v-490c5a89"]]),Re={class:"mp-form"},ke={__name:"FormAsistenciaUgo",emits:["loaded","registered"],setup(u,{emit:m}){const _=m,c=y(null),S=y(!1);de(),y(!1);const f=C({}),r=z();re();const E=y(!1),M=y(1),e=C({num_soons:0,obs_ruc:null,obs_dni:null,ruc:null});D("formState",e),D("loadingStates",f),D("loadingSubmit",E);const d=C([{type:"title",label:"Datos de la Empresa",md:12},{type:"search",label:"Número de RUC",model:"ruc",required:!1,max:11,disabled:!1},{type:"text",label:"Razón Social",model:"razonSocial",required:!1,disabled:!1},{type:"text",label:"Nombre Comercial (marca)",model:"comercialName",required:!1},{type:"select",label:"Sector Económico",model:"economicsector_id",required:!0,options:[],disabled:!1},{type:"select",label:"Rubro",model:"rubro_id",required:!0,options:[],disabled:!1},{type:"select",label:"Actividad Comercial",model:"comercialactivity_id",required:!1,options:[],disabled:!1},{type:"select",label:"Región",model:"city_id",required:!0,options:[],disabled:!1},{type:"select",label:"Provincia",model:"province_id",required:!0,options:[],disabled:!1},{type:"select",label:"Distrito",model:"district_id",required:!0,options:[],disabled:!1},{type:"title",label:"Datos del Participante",md:12},{type:"select",label:"Tipo de documento",model:"typedocument_id",required:!0,options:[]},{type:"search",label:"Número de Documento",model:"documentnumber",required:!0,max:8,disabled:!1},{type:"text",label:"Apellido Paterno",model:"lastname",required:!0,disabled:!0},{type:"text",label:"Apellido Materno",model:"middlename",required:!0,disabled:!0},{type:"text",label:"Nombres",model:"name",required:!0,disabled:!0},{type:"select",label:"Género",model:"gender_id",required:!0,options:[]},{type:"select",label:"¿Tiene alguna discapacidad?",model:"sick",required:!0,options:[{label:"SI",value:"si"},{label:"NO",value:"no"}]},{type:"email",label:"Correo electrónico",model:"email",required:!0},{type:"number",label:"Número de celular",model:"phone",required:!0,max:9,minLength:9},{type:"select",label:"País de nacimiento",model:"country_id",required:!0,options:[]}]),Y=i=>{const t=d.find(a=>a.model===i);M.value==1&&i=="ruc"&&(t.disabled=!t.disabled,V()),i=="documentnumber"&&R()},V=()=>{e.ruc=null,e.razonSocial=null,e.comercialName=null,e.economicsector_id=null,e.rubro_id=null,e.comercialactivity_id=null,e.city_id=null,e.province_id=null,e.district_id=null},R=()=>{e.typedocument_id=null,e.documentnumber=null,e.name=null,e.lastname=null,e.middlename=null,e.gender_id=null,e.sick=null,e.phone=null,e.email=null,e.country_id=null},j=async(i,t)=>{if(i.model=="rubro_id"){e.comercialactivity_id=null;const a=await g({url:`select/activity-by-rubro/${i.value}`,method:"GET"}),o=d.find(n=>n.model==="comercialactivity_id");o.options=a.data}if(i.model=="city_id"){e.province_id=null,e.district_id=null;const a=`select/provinces/${i.value}`;b(a,"province_id")}if(i.model=="province_id"){e.district_id=null;const a=`select/districts/${i.value}`;b(a,"district_id")}if(i.model==="typedocument_id"){const a=d.find(k=>k.model==="documentnumber");if(!a)return;const o={1:{max:8,autolockNames:!0},2:{max:9,autolockNames:!1},3:{max:12,autolockNames:!1},default:{max:9,autolockNames:!1}},n=o[i.value]||o.default;a.max=n.max,i.value&&R(),["name","lastname","middlename"].forEach(k=>{const A=d.find(ie=>ie.model===k);A&&(A.disabled=n.autolockNames)}),a.disabled=!1}if(i.model==="documentnumber"){const a=d.find(o=>o.model==="documentnumber");a&&(a.disabled=!1)}},G=async i=>{if(i=="ruc")return H();if(i=="documentnumber")return B()},H=async()=>{try{const i=await g({url:`mp/ruc-number/${e.ruc}`,method:"POST"});if(i.status==409&&["razonSocial"].forEach(t=>{const a=d.find(o=>o.model===t);a&&(a.disabled=!1),e.obs_ruc=1}),i.status==200){const{data:t}=i;e.razonSocial=t.social_reason,e.economicsector_id=t.economic_sector_id,e.rubro_id=t.rubro_id,await b(`select/activity-by-rubro/${t.rubro_id}`,"comercialactivity_id"),e.comercialactivity_id=t.comercial_activity_id,e.city_id=t.city_id,await b(`select/provinces/${t.city_id}`,"province_id"),e.province_id=t.province_id,await b(`select/districts/${t.province_id}`,"district_id"),e.district_id=t.district_id}f.ruc=!1}catch(i){console.log("Error: ",i)}},B=async()=>{try{const i=await g({url:`mp/dni-number/${e.documentnumber}`,method:"POST"});if(i.status==409&&["documentnumber","name","lastname","middlename"].forEach(t=>{const a=d.find(o=>o.model===t);a&&(a.disabled=!1),e.obs_dni=1}),i.status==201){const{data:t}=i;e.lastname=t.last_name,e.middlename=t.middle_name,e.name=t.names}if(i.status==200){const{data:t}=i;e.name=t.names,e.lastname=t.last_name,e.middlename=t.middle_name,e.gender_id=t.gender_id,e.sick=t.sick,e.academicdegree_id=t.academicdegree_id,e.civil_status_id=t.civil_status_id,e.num_soons=t.num_soons,e.birthday=w(t.date_of_birth).format("DD/MM/YYYY"),e.phone=t.phone,e.email=t.email,e.role_company_id=t.role_company_id,e.country_id=t.country_id}f.documentnumber=!1}catch(i){console.log("Error: ",i)}},I=async()=>{E.value=!0;const i={slug:r.params.slug,ruc:e.ruc,socialReason:e.razonSocial,comercialName:e.comercialName,economicsector_id:e.economicsector_id,category_id:e.rubro_id,comercialactivity_id:e.comercialactivity_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,typedocument_id:e.typedocument_id,documentnumber:e.documentnumber,lastname:e.lastname,middlename:e.middlename,name:e.name,gender_id:e.gender_id,sick:e.sick,email:e.email,phone:e.phone,country_id:e.country_id};try{const t=await g({url:"public/attendance-present",method:"POST",data:i});t.status==200&&(S.value=!0,c.value=t.message,V(),R())}catch(t){console.log("Error: ",t)}finally{E.value=!1}},q=i=>{Array.isArray(d)&&["razonSocial","lastname","middlename","name"].forEach(t=>{const a=d.find(o=>o.model===t);a&&(a.disabled=i)})},b=async(i,t)=>{try{const a=await g({url:i,method:"GET"}),o=d.find(n=>n.model===t);o&&a.data&&(o.options=a.data)}catch(a){console.error("Error de red:",a)}},U=async i=>{const t=await g({url:`select/activity-by-rubro/${i}`,method:"GET"}),a=d.find(o=>o.model==="comercialactivity_id");a.options=t.data},{loadSectorEconomico:L,loadRubros:K,loadCountries:J,loadCity:Q,loadTypeDocuments:W,loadGenders:X,loadCivilStatus:Z,loadAcademicDegree:ee,loadRoleCompany:te}=_e(d);return O(async()=>{await L(),await K(),await Q(),await W(),await X(),await Z(),await J(),await ee(),await te(),e.country_id=155}),ne(()=>r.query,i=>{if(Object.keys(i).length){e.id=i.participant_id;const t={},a=["ruc","dni","phone"];Object.entries(i).forEach(([o,n])=>{n==="null"?t[o]=null:!a.includes(o)&&n!==""&&!isNaN(n)?t[o]=Number(n):t[o]=n}),e.ruc=t.ruc,e.razonSocial=t.socialReason,e.economicsector_id=t.economic_sector_id,e.rubro_id=t.rubro_id,U(t.rubro_id),e.comercialactivity_id=t.comercial_activity_id,e.city_id=t.city_id,b(`select/provinces/${t.city_id}`,"province_id"),e.province_id=t.province_id,b(`select/districts/${t.province_id}`,"district_id"),e.district_id=t.district_id,e.typedocument_id=t.t_doc_id,e.documentnumber=t.dni,e.lastname=t.last_name,e.middlename=t.middle_name,e.name=t.name,e.country_id=t.country_id,e.gender_id=t.gender_id,e.sick=t.sick,e.academicdegree_id=t.academicdegree_id,e.civil_status_id=t.civil_status_id,e.num_soons=t.numSoons,e.phone=t.phone,e.email=t.email,e.birthday=w(t.date_of_birth).format("DD/MM/YYYY"),e.role_company_id=t.role_company_id,setTimeout(()=>{_("loaded",!0)},2500),q(!1)}else q(!0)},{immediate:!0}),(i,t)=>(N(),T("div",Re,[l(ue,{colorForm:"#0f7eb3",fields:d,onSearchDataApi:G,onSubmit:I,nameBtnSend:"REGISTRAR",onChange:j,onHandleClearSearch:Y},null,8,["fields"]),l(fe,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=a=>S.value=a),location:"top right",color:"success",timeout:"3000",elevation:"6"},{default:s(()=>[l(x,{start:""},{default:s(()=>t[1]||(t[1]=[p("mdi-check-circle")])),_:1,__:[1]}),p(" "+h(c.value),1)]),_:1},8,["modelValue"])]))}},Ce={class:"mp"},Ie={__name:"[slug]",setup(u){ae("Registro de actividades","Registro de actividades","pp.ico"),y(!0);const m=y(!0),_=y({}),c=z(),S=async()=>{try{const f=c.params.slug,r=await g({url:`public/data-attendance/${f}`,method:"GET"});console.log("response",r),r.status===200&&(_.value=(r==null?void 0:r.data)||{}),console.log("response",r)}catch(f){console.error("Error de red:",f)}finally{m.value=!1}};return O(async()=>{await S()}),(f,r)=>(N(),$(pe,{class:"py-0",fluid:""},{default:s(()=>[l(F,{align:"center",justify:"center"},{default:s(()=>[l(P,{cols:"12",sm:"12",md:"10",lg:"8",xl:"6",class:"my-2"},{default:s(()=>[l(ce,{"model-value":m.value,class:"align-center justify-center",persistent:"",scrim:""},{default:s(()=>[l(me,{color:"#0f7eb3",size:"64",indeterminate:""})]),_:1},8,["model-value"]),m.value?se("",!0):(N(),$(ye,{key:0,elevation:"8",rounded:"lg"},{default:s(()=>[l(Ne,{detailEvent:_.value},null,8,["detailEvent"]),v("div",Ce,[l(ke,{onLoaded:r[0]||(r[0]=E=>m.value=!1)})])]),_:1}))]),_:1})]),_:1})]),_:1}))}};export{Ie as default};
