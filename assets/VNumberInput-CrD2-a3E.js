import{a4 as ce,g as se,p as de,r as ve,aV as fe,h as P,s as J,e as me,A as pe,aJ as z,aF as ge,t as A,w as W,o as we,l as be,a9 as Z,j as b,i as m,F as B,B as Ne,V as q,D as Q,aB as he,aC as De,aW as Pe,N as Ve,aX as xe,aY as Ie}from"./index-jRjXo8Vc.js";import{f as R}from"./VSnackbar-DCv-iCsn.js";const Fe=50,Se=500;function Ee(n){let{toggleUpDown:L}=n,u=-1,w=-1;ce(d);function S(l){d(),V(l),window.addEventListener("pointerup",d),document.addEventListener("blur",d),u=window.setTimeout(()=>{w=window.setInterval(()=>V(l),Fe)},Se)}function d(){window.clearTimeout(u),window.clearInterval(w),window.removeEventListener("pointerup",d),document.removeEventListener("blur",d)}function V(l){L(l==="up")}return{holdStart:S,holdStop:d}}const ye=de({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},minFractionDigits:{type:Number,default:null},decimalSeparator:{type:String,validator:n=>!n||n.length===1},...De(Pe(),["modelValue","validationValue"])},"VNumberInput"),ke=se()({name:"VNumberInput",props:{...ye()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,L){let{slots:u}=L;const w=ve(),{holdStart:S,holdStop:d}=Ee({toggleUpDown:U}),V=fe(n),l=P(()=>V.isDisabled.value||V.isReadonly.value),E=J(n.focused),{decimalSeparator:ee}=me(),c=P(()=>{var e;return((e=n.decimalSeparator)==null?void 0:e[0])||ee.value});function N(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const g=t==null?String(e):e.toFixed(t);if(E.value&&r)return Number(g).toString().replace(".",c.value);if(n.minFractionDigits===null||t!==null&&t<n.minFractionDigits)return g.replace(".",c.value);let[h,o]=g.split(".");return o=(o??"").padEnd(n.minFractionDigits,"0").replace(new RegExp(`(?<=\\d{${n.minFractionDigits}})0`,"g"),""),[h,o].filter(Boolean).join(c.value)}const a=pe(n,"modelValue",null,e=>e??null,e=>e==null?e??null:z(Number(e),n.min,n.max)),x=J(null);ge(()=>{E.value&&!l.value||(a.value==null?x.value=null:isNaN(a.value)||(x.value=N(a.value)))});const s=P({get:()=>x.value,set(e){if(e===null||e===""){a.value=null,x.value=null;return}const t=Number(e.replace(c.value,"."));!isNaN(t)&&t<=n.max&&t>=n.min&&(a.value=t,x.value=e)}}),M=P(()=>l.value?!1:(a.value??0)+n.step<=n.max),$=P(()=>l.value?!1:(a.value??0)-n.step>=n.min),i=P(()=>n.hideInput?"stacked":n.controlVariant),H=A(()=>i.value==="split"?"$plus":"$collapse"),K=A(()=>i.value==="split"?"$minus":"$expand"),y=A(()=>i.value==="split"?"default":"small"),C=A(()=>i.value==="stacked"?"auto":"100%"),ne={props:{onClick:T,onPointerup:p,onPointerdown:j,onPointercancel:p}},te={props:{onClick:T,onPointerup:p,onPointerdown:G,onPointercancel:p}};W(()=>n.precision,()=>X()),W(()=>n.minFractionDigits,()=>X()),we(()=>{_()});function O(e){if(e==null)return 0;const t=e.toString(),r=t.indexOf(".");return~r?t.length-r:0}function U(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(l.value)return;if(a.value==null){s.value=N(z(0,n.min,n.max));return}let t=Math.max(O(a.value),O(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?M.value&&(s.value=N(a.value+n.step,t)):$.value&&(s.value=N(a.value-n.step,t))}function ae(e){var k;if(!e.data)return;const t=e.target,{value:r,selectionStart:g,selectionEnd:h}=t??{},o=r?r.slice(0,g)+e.data+r.slice(h):e.data,D=xe(o,n.precision,c.value);new RegExp(`^-?\\d*${Ie(c.value)}?\\d*$`).test(o)||(e.preventDefault(),t.value=D),n.precision!=null&&(((k=o.split(c.value)[1])==null?void 0:k.length)>n.precision&&(e.preventDefault(),t.value=D),n.precision===0&&o.includes(c.value)&&(e.preventDefault(),t.value=D))}async function ue(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),_(),await Ve(),e.key==="ArrowDown"?U(!1):U())}function T(e){e.stopPropagation()}function p(e){const t=e.currentTarget;t==null||t.releasePointerCapture(e.pointerId),e.preventDefault(),d()}function j(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),S("up")}function G(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),S("down")}function _(){if(l.value||!w.value)return;const e=w.value.value,t=Number(e.replace(c.value,"."));e&&!isNaN(t)?s.value=N(z(t,n.min,n.max)):s.value=null}function X(){l.value||(s.value=a.value!==null&&!isNaN(a.value)?N(a.value,n.precision,!1):null)}function le(){if(!l.value){if(a.value===null||isNaN(a.value)){s.value=null;return}s.value=a.value.toString().replace(".",c.value)}}function ie(){le()}function re(){_()}return be(()=>{const{modelValue:e,...t}=Z.filterProps(n);function r(){return u.increment?m(Q,{key:"increment-defaults",defaults:{VBtn:{disabled:!M.value,flat:!0,height:C.value,size:y.value,icon:H.value}}},{default:()=>[u.increment(ne)]}):m(q,{"aria-hidden":"true","data-testid":"increment",disabled:!M.value,flat:!0,height:C.value,icon:H.value,key:"increment-btn",onClick:T,onPointerdown:j,onPointerup:p,onPointercancel:p,size:y.value,tabindex:"-1"},null)}function g(){return u.decrement?m(Q,{key:"decrement-defaults",defaults:{VBtn:{disabled:!$.value,flat:!0,height:C.value,size:y.value,icon:K.value}}},{default:()=>[u.decrement(te)]}):m(q,{"aria-hidden":"true","data-testid":"decrement",disabled:!$.value,flat:!0,height:C.value,icon:K.value,key:"decrement-btn",onClick:T,onPointerdown:G,onPointerup:p,onPointercancel:p,size:y.value,tabindex:"-1"},null)}function h(){return b("div",{class:"v-number-input__control"},[g(),m(R,{vertical:i.value!=="stacked"},null),r()])}function o(){return!n.hideInput&&!n.inset?m(R,{vertical:!0},null):void 0}const D=i.value==="split"?b("div",{class:"v-number-input__control"},[m(R,{vertical:!0},null),r()]):n.reverse||i.value==="hidden"?void 0:b(B,null,[o(),h()]),k=u["append-inner"]||D,Y=i.value==="split"?b("div",{class:"v-number-input__control"},[g(),m(R,{vertical:!0},null)]):n.reverse&&i.value!=="hidden"?b(B,null,[h(),o()]):void 0,oe=u["prepend-inner"]||Y;return m(Z,Ne({ref:w},t,{modelValue:s.value,"onUpdate:modelValue":v=>s.value=v,focused:E.value,"onUpdate:focused":v=>E.value=v,validationValue:a.value,onBeforeinput:ae,onFocus:ie,onBlur:re,onKeydown:ue,class:["v-number-input",{"v-number-input--default":i.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":i.value==="split","v-number-input--stacked":i.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...u,"append-inner":k?function(){var F;for(var v=arguments.length,I=new Array(v),f=0;f<v;f++)I[f]=arguments[f];return b(B,null,[(F=u["append-inner"])==null?void 0:F.call(u,...I),D])}:void 0,"prepend-inner":oe?function(){var F;for(var v=arguments.length,I=new Array(v),f=0;f<v;f++)I[f]=arguments[f];return b(B,null,[Y,(F=u["prepend-inner"])==null?void 0:F.call(u,...I)])}:void 0})}),he({},w)}});export{ke as V};
