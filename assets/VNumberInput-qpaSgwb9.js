import{u as ce,S as se,R as de,r as ve,aL as me,j as P,s as Z,a3 as fe,T as pe,ax as z,an as ge,g as R,m as q,y as be,ap as we,D as J,b as w,a as f,F as A,G as Ne,I as Q,a5 as W,at as he,aM as De,aN as Pe,K as xe,aO as Ve,aP as Ie}from"./index-dWNYWhpY.js";import{d as B}from"./VSnackbar-DSV00IUq.js";const Se=50,Fe=500;function ye(n){let{toggleUpDown:L}=n,u=-1,b=-1;ce(d);function F(l){d(),x(l),window.addEventListener("pointerup",d),document.addEventListener("blur",d),u=window.setTimeout(()=>{b=window.setInterval(()=>x(l),Se)},Fe)}function d(){window.clearTimeout(u),window.clearInterval(b),window.removeEventListener("pointerup",d),document.removeEventListener("blur",d)}function x(l){L(l==="up")}return{holdStart:F,holdStop:d}}const Ee=de({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},minFractionDigits:{type:Number,default:null},decimalSeparator:{type:String,validator:n=>!n||n.length===1},...De(Pe(),["modelValue","validationValue"])},"VNumberInput"),ke=se()({name:"VNumberInput",props:{...Ee()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,L){let{slots:u}=L;const b=ve(),{holdStart:F,holdStop:d}=ye({toggleUpDown:U}),x=me(n),l=P(()=>x.isDisabled.value||x.isReadonly.value),y=Z(n.focused),{decimalSeparator:ee}=fe(),c=P(()=>{var e;return((e=n.decimalSeparator)==null?void 0:e[0])||ee.value});function N(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const g=t==null?String(e):e.toFixed(t);if(y.value&&r)return Number(g).toString().replace(".",c.value);if(n.minFractionDigits===null||t!==null&&t<n.minFractionDigits)return g.replace(".",c.value);let[h,o]=g.split(".");return o=(o??"").padEnd(n.minFractionDigits,"0").replace(new RegExp(`(?<=\\d{${n.minFractionDigits}})0`,"g"),""),[h,o].filter(Boolean).join(c.value)}const a=pe(n,"modelValue",null,e=>e??null,e=>e==null?e??null:z(Number(e),n.min,n.max)),V=Z(null);ge(()=>{y.value&&!l.value||(a.value==null?V.value=null:isNaN(a.value)||(V.value=N(a.value)))});const s=P({get:()=>V.value,set(e){if(e===null||e===""){a.value=null,V.value=null;return}const t=Number(e.replace(c.value,"."));!isNaN(t)&&t<=n.max&&t>=n.min&&(a.value=t,V.value=e)}}),M=P(()=>l.value?!1:(a.value??0)+n.step<=n.max),$=P(()=>l.value?!1:(a.value??0)-n.step>=n.min),i=P(()=>n.hideInput?"stacked":n.controlVariant),H=R(()=>i.value==="split"?"$plus":"$collapse"),K=R(()=>i.value==="split"?"$minus":"$expand"),E=R(()=>i.value==="split"?"default":"small"),T=R(()=>i.value==="stacked"?"auto":"100%"),ne={props:{onClick:C,onPointerup:p,onPointerdown:G,onPointercancel:p}},te={props:{onClick:C,onPointerup:p,onPointerdown:j,onPointercancel:p}};q(()=>n.precision,()=>X()),q(()=>n.minFractionDigits,()=>X()),be(()=>{_()});function O(e){if(e==null)return 0;const t=e.toString(),r=t.indexOf(".");return~r?t.length-r:0}function U(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(l.value)return;if(a.value==null){s.value=N(z(0,n.min,n.max));return}let t=Math.max(O(a.value),O(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?M.value&&(s.value=N(a.value+n.step,t)):$.value&&(s.value=N(a.value-n.step,t))}function ae(e){var k;if(!e.data)return;const t=e.target,{value:r,selectionStart:g,selectionEnd:h}=t??{},o=r?r.slice(0,g)+e.data+r.slice(h):e.data,D=Ve(o,n.precision,c.value);new RegExp(`^-?\\d*${Ie(c.value)}?\\d*$`).test(o)||(e.preventDefault(),t.value=D),n.precision!=null&&(((k=o.split(c.value)[1])==null?void 0:k.length)>n.precision&&(e.preventDefault(),t.value=D),n.precision===0&&o.includes(c.value)&&(e.preventDefault(),t.value=D))}async function ue(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),_(),await xe(),e.key==="ArrowDown"?U(!1):U())}function C(e){e.stopPropagation()}function p(e){const t=e.currentTarget;t==null||t.releasePointerCapture(e.pointerId),e.preventDefault(),d()}function G(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),F("up")}function j(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),F("down")}function _(){if(l.value||!b.value)return;const e=b.value.value,t=Number(e.replace(c.value,"."));e&&!isNaN(t)?s.value=N(z(t,n.min,n.max)):s.value=null}function X(){l.value||(s.value=a.value!==null&&!isNaN(a.value)?N(a.value,n.precision,!1):null)}function le(){if(!l.value){if(a.value===null||isNaN(a.value)){s.value=null;return}s.value=a.value.toString().replace(".",c.value)}}function ie(){le()}function re(){_()}return we(()=>{const{modelValue:e,...t}=J.filterProps(n);function r(){return u.increment?f(W,{key:"increment-defaults",defaults:{VBtn:{disabled:!M.value,flat:!0,height:T.value,size:E.value,icon:H.value}}},{default:()=>[u.increment(ne)]}):f(Q,{"aria-hidden":"true","data-testid":"increment",disabled:!M.value,flat:!0,height:T.value,icon:H.value,key:"increment-btn",onClick:C,onPointerdown:G,onPointerup:p,onPointercancel:p,size:E.value,tabindex:"-1"},null)}function g(){return u.decrement?f(W,{key:"decrement-defaults",defaults:{VBtn:{disabled:!$.value,flat:!0,height:T.value,size:E.value,icon:K.value}}},{default:()=>[u.decrement(te)]}):f(Q,{"aria-hidden":"true","data-testid":"decrement",disabled:!$.value,flat:!0,height:T.value,icon:K.value,key:"decrement-btn",onClick:C,onPointerdown:j,onPointerup:p,onPointercancel:p,size:E.value,tabindex:"-1"},null)}function h(){return w("div",{class:"v-number-input__control"},[g(),f(B,{vertical:i.value!=="stacked"},null),r()])}function o(){return!n.hideInput&&!n.inset?f(B,{vertical:!0},null):void 0}const D=i.value==="split"?w("div",{class:"v-number-input__control"},[f(B,{vertical:!0},null),r()]):n.reverse||i.value==="hidden"?void 0:w(A,null,[o(),h()]),k=u["append-inner"]||D,Y=i.value==="split"?w("div",{class:"v-number-input__control"},[g(),f(B,{vertical:!0},null)]):n.reverse&&i.value!=="hidden"?w(A,null,[h(),o()]):void 0,oe=u["prepend-inner"]||Y;return f(J,Ne({ref:b},t,{modelValue:s.value,"onUpdate:modelValue":v=>s.value=v,focused:y.value,"onUpdate:focused":v=>y.value=v,validationValue:a.value,onBeforeinput:ae,onFocus:ie,onBlur:re,onKeydown:ue,class:["v-number-input",{"v-number-input--default":i.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":i.value==="split","v-number-input--stacked":i.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...u,"append-inner":k?function(){var S;for(var v=arguments.length,I=new Array(v),m=0;m<v;m++)I[m]=arguments[m];return w(A,null,[(S=u["append-inner"])==null?void 0:S.call(u,...I),D])}:void 0,"prepend-inner":oe?function(){var S;for(var v=arguments.length,I=new Array(v),m=0;m<v;m++)I[m]=arguments[m];return w(A,null,[Y,(S=u["prepend-inner"])==null?void 0:S.call(u,...I)])}:void 0})}),he({},b)}});export{ke as V};
