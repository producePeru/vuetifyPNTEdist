import{r as n,c as f,b as l,e as t,w as a,d as r,q as ce,t as g,g as d,V as $,_ as de,s as Y,i as me,v as fe,h as F,o as pe,f as D,m as ve,F as ge,j as ye,n as z,l as C,x as Ve,y as M,z as _e,A as we,B as Q,C as xe,D as O}from"./index-DdXFwoKA.js";import{u as be}from"./usePageMeta-CQWQEsFO.js";import{h as S}from"./httpRequest-D3KC4pOG.js";import{d as L,V as U}from"./VDialog-CcHf3q6Q.js";import"./es-CwGK4w58.js";import{V as R,a as G}from"./VRow-BQlREuyd.js";import{V as he}from"./VAvatar-BN75WEmc.js";import{_ as Ce}from"./EventFinalized-7uyWXJYh.js";import{u as ke,a as Ee,b as De,c as $e,H as Se}from"./useDynamicManifest-2-SnuQmf.js";import{u as Te,c as T,m as Ne,r as je}from"./index-LRRaG21R.js";import{V as q}from"./VContainer-BZ1L2Djm.js";import{V as Ie}from"./VTooltip-BZxIBhOX.js";import{V as J,a as Ae,b as X,c as K}from"./VCard-binWRFly.js";/* empty css                                                       */const W="/assets/logo-mujer-produce-C0VJlXqa.png",Me={style:{"line-height":"2"}},Re={style:{"list-style":"none","padding-left":"0"}},qe={__name:"DetalleAsistenciaMujerProduce",props:{color:String,title:String,eventType:String,info:Object,modal:Boolean},setup(w){L.locale("es");const p=k=>k?L(k).format("DD/MM/YYYY"):"";return n(!0),(k,u)=>(l(),f("section",null,[t(G,{justify:"center",align:"center",class:"h-100"},{default:a(()=>[t(R,{cols:"auto"},{default:a(()=>[t(he,{width:200,src:W})]),_:1})]),_:1}),t(G,null,{default:a(()=>[t(R,{cols:"12",class:"text-center"},{default:a(()=>{var y;return[r("h1",{class:"title",style:ce({color:w.color})},g((y=w.info)==null?void 0:y.title),5)]}),_:1}),t(R,null,{default:a(()=>{var y,V,m;return[r("div",Me,[u[3]||(u[3]=r("h4",null,"Información",-1)),r("ul",Re,[r("li",null,[t($,null,{default:a(()=>u[0]||(u[0]=[d("mdi-map-marker")])),_:1,__:[0]}),d(" LUGAR: "+g((y=w.info)==null?void 0:y.place),1)]),r("li",null,[t($,{left:""},{default:a(()=>u[1]||(u[1]=[d("mdi-calendar")])),_:1,__:[1]}),d(" FECHA: "+g(p((V=w.info)==null?void 0:V.fecha)),1)]),r("li",null,[t($,{left:""},{default:a(()=>u[2]||(u[2]=[d("mdi-clock-time-four-outline")])),_:1,__:[2]}),d(" HORARIO: "+g((m=w.info)==null?void 0:m.schedule),1)])])])]}),_:1})]),_:1})]))}},Pe={class:"pp03-background"},Be={class:"container-asistance"},He={key:0,class:"my-10"},Ye={key:1,class:"text-center d-flex align-center justify-center"},Fe={key:0,class:"qr-modal-user"},ze={class:"mt-3"},Qe={key:1,class:"qr-modal-user"},Oe=["src"],Le={key:2,class:"qr-modal-user"},Ue={__name:"[slug]",setup(w){be("Mujer Produce","Registrar asistencia al SED","mujerproduce.ico");const p=me(),k=ye(),u=Y(`https://inscripcion.soporte-pnte.com/sed/${p.params.slug}`),y=ke(u,{errorCorrectionLevel:"H",margin:3}),V=n(null),m=n(!1),Z=n(null),x=n(null),N=n(null),E=n(!1),ee=Y(""),j=n(null),b=n(!1);n(!1);const P=n(!1),B=n("#f51177"),I=fe(()=>!!i.documentnumber&&v.value.documentnumber.$dirty&&!v.value.documentnumber.$invalid),h=n(!1);let _=null;const te=async()=>{h.value=!0,await O(),ae()},ae=async()=>{try{if(m.value=!0,_&&await A(),!document.getElementById("reader")){console.warn("Elemento reader no encontrado"),m.value=!1;return}_=new Se("reader"),await _.start({facingMode:"environment"},{fps:10,qrbox:250},e=>{i.documentnumber=e,v.value.$touch(),h.value=!1,A()},e=>{})}catch(s){console.error("No se pudo iniciar el escáner:",s),alert("No se pudo acceder a la cámara. Verifica los permisos del navegador."),h.value=!1}finally{m.value=!1}},A=async()=>{try{m.value=!0,_&&(await _.stop().catch(()=>{}),await _.clear(),_=null)}catch(s){console.error("Error al detener el escáner:",s)}finally{m.value=!1}},se=F({documentnumber:null}),i=F({...se}),re=T.withMessage("Corrige el número de documento",T.regex(/^\d+$/)),oe={documentnumber:{required:T.withMessage("Ingresar número de documento",je),minLength:T.withMessage("Completa el número de identidad",Ne(8)),validDni:re}},le=async()=>{var e,o;E.value=!1,ee.value="",N.value=null,await O();const s=(o=(e=Z.value)==null?void 0:e.$el)==null?void 0:o.querySelector("input");s&&s.focus()},ne=async()=>{try{const s={slug:p.params.slug,dni:i.documentnumber},e=await S({url:"public/participant-info",method:"POST",data:s});if(e.status==200)return N.value=e,await ue(e.doc);x.value="no-se-registro",i.documentnumber=null,v.value.$reset(),E.value=!0}catch{console.error("Error ejecutando reCAPTCHA:",error)}},ue=async s=>{try{const e={dni:s,slug:p.params.slug,attended:De($e(),"DD/MM/YYYY HH:mm a").value},o=await S({url:"public/register-attendance",method:"PUT",data:e});if(E.value=!0,o.status==200)return i.documentnumber=null,v.value.$reset(),H(),x.value="asistio";x.value="ya-estas-registrado",i.documentnumber=null,v.value.$reset()}catch{console.error("Error ejecutando reCAPTCHA:",error)}},ie=async()=>{try{b.value=!0;const s=p.params.slug,e=await S({url:`public/event-sed-details/${s}`,method:"GET"});if(e.status==400)return k.replace("/pagina-no-encontrada");if(e.status==404)return P.value=!0;const o=e.data;j.value=o,e.status==200&&(i.slug=o.slug,b.value=!1)}catch(s){console.error("Error de red:",s)}finally{b.value=!1}},H=async()=>{try{const s=p.params.slug,e=await S({url:`public/data-event-count/${s}`,method:"GET"});e.status==200&&(V.value=e.data)}catch(s){console.error("Error de red:",s)}finally{b.value=!1}},v=Te(oe,i);return pe(async()=>{await ie(),await H(),Ee("SED | 2025",p.params.slug)}),(s,e)=>(l(),f("section",Pe,[r("div",Be,[t(ve,{"model-value":b.value,class:"align-center justify-center",persistent:"",scrim:""},{default:a(()=>[t(z,{color:"primary",size:"64",indeterminate:""})]),_:1},8,["model-value"]),P.value?(l(),D(q,{key:0,class:"pp03-container"},{default:a(()=>[t(Ce)]),_:1})):(l(),f(ge,{key:1},[b.value?(l(),D(q,{key:0,class:"pp03-container"})):(l(),D(q,{key:1,class:"pp03-container"},{default:a(()=>{var o;return[t(qe,{color:B.value,info:j.value,title:"SESIÓN DE ENTRETANIENTO DIGITAL",eventType:"sed"},null,8,["color","info"]),((o=j.value)==null?void 0:o.status)!=404?(l(),f("div",He,[t(Ve,{class:"input-search-dni",color:B.value,modelValue:i.documentnumber,"onUpdate:modelValue":e[1]||(e[1]=c=>i.documentnumber=c),counter:11,maxlength:11,"error-messages":M(v).documentnumber.$errors.map(c=>c.$message),label:"Número de documento",density:"comfortable",variant:"outlined",onInput:M(v).documentnumber.$touch},{"append-inner":a(()=>[t(Ie,{text:I.value?"Buscar por DNI":"Escanear DNI",location:"top"},{activator:a(({props:c})=>[m.value?(l(),D(z,{key:0,indeterminate:"",color:"primary",size:"20",class:"me-2"})):(l(),D($,_e({key:1},c,{class:"me-2 btn-input-search",onClick:e[0]||(e[0]=we(Ge=>I.value?ne():te(),["stop"]))}),{default:a(()=>[d(g(I.value?"mdi-magnify":"mdi-qrcode-scan"),1)]),_:2},1040))]),_:1},8,["text"])]),_:1},8,["color","modelValue","error-messages","onInput"]),t(U,{modelValue:h.value,"onUpdate:modelValue":[e[3]||(e[3]=c=>h.value=c),e[4]||(e[4]=c=>{c||A()})],fullscreen:"",transition:"dialog-bottom-transition",persistent:""},{default:a(()=>[t(J,{class:"d-flex flex-column align-center justify-center",style:{"background-color":"#000"}},{default:a(()=>[t(Ae,{class:"text-white text-h6 text-center mt-4"},{default:a(()=>e[6]||(e[6]=[d("Escanear código")])),_:1,__:[6]}),t(X,{class:"d-flex justify-center"},{default:a(()=>e[7]||(e[7]=[r("div",{id:"reader",style:{width:"90vw","max-width":"400px"}},null,-1)])),_:1,__:[7]}),t(K,{class:"justify-center mt-4"},{default:a(()=>[t(Q,{color:"red",variant:"flat",onClick:e[2]||(e[2]=c=>h.value=!1)},{default:a(()=>e[8]||(e[8]=[d(" Cancelar ")])),_:1,__:[8]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):C("",!0),V.value?(l(),f("div",Ye,[t($,{size:"18",class:"mr-1",color:"grey darken-1"},{default:a(()=>e[9]||(e[9]=[d("mdi-pound")])),_:1,__:[9]}),r("h2",null,g(V.value.amountNow)+" / "+g(V.value.total),1)])):C("",!0)]}),_:1}))],64))]),t(U,{modelValue:E.value,"onUpdate:modelValue":e[5]||(e[5]=o=>E.value=o),"max-width":"500",persistent:""},{default:a(()=>[t(J,null,{default:a(()=>[t(X,null,{default:a(()=>{var o;return[x.value=="asistio"?(l(),f("div",Fe,[e[10]||(e[10]=r("p",null,"¡Bienvenido al evento!",-1)),r("h2",ze,g((o=N.value)==null?void 0:o.name),1),e[11]||(e[11]=r("img",{src:W,width:"160",class:"mt-8"},null,-1)),e[12]||(e[12]=r("p",{style:{"font-size":"14px",color:"#777","margin-top":"10px"}}," Nos alegra contar con tu presencia. Prepárate para una experiencia única llena de aprendizaje, inspiración y conexión. ",-1))])):C("",!0),x.value=="no-se-registro"?(l(),f("div",Qe,[e[13]||(e[13]=r("p",null,"No estas registrado",-1)),e[14]||(e[14]=r("h2",{class:"mt-3"},"Escanea el código QR para registrarte",-1)),u.value?(l(),f("img",{key:0,class:"mt-6 mb-2 rounded border",src:M(y),alt:"QR Code"},null,8,Oe)):C("",!0)])):C("",!0),x.value=="ya-estas-registrado"?(l(),f("div",Le,e[15]||(e[15]=[r("h2",{class:"mt-3"},"Ya has sido registrado",-1)]))):C("",!0)]}),_:1}),t(K,null,{default:a(()=>[t(xe),t(Q,{text:"Cerrar",onClick:le})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},it=de(Ue,[["__scopeId","data-v-d0738dd4"]]);export{it as default};
