import{_ as ee}from"./mp-logo-CPdgfx02.js";import{u as te}from"./usePageMeta-Ccp0vYGM.js";import{h as _}from"./httpRequest-B4w4n6I1.js";import{_ as ie}from"./FormComponent-C9eXRhEV.js";import{u as ae}from"./useFormOptions-DXP8M4Jp.js";import{ad as oe,r as h,$ as S,Z as $,a1 as le,w as re,o as z,c as C,b as v,i as r,z as k,P as V,Q as d,R as de,a0 as se,X as ne,j as c,Y as g,T as m,U as x,V as ce}from"./index-C0BxnROc.js";import{d as D}from"./VDialog-B-EaVIof.js";import{V as N}from"./VContainer-CarOZzXr.js";import{V as P,a as T}from"./VRow-TNJBDYyf.js";import{V as ue}from"./VCard-CLncIZC_.js";import{V as me}from"./VImg-C-C_kDdR.js";import"./index-BJsfWxQv.js";import"./VSnackbar-DdXsE4ar.js";import"./VList-LYmgYoeL.js";import"./VAvatar-BlteH7pT.js";import"./ssrBoot-CifwsCzt.js";import"./VForm-CY7Wuu6-.js";const _e={class:"mp-form"},pe={__name:"MujerProduceForm",setup(A){const w=oe(),y=h(!1),s=S({}),p=$();le();const u=h(!1),o=h(1),e=S({num_soons:0,obs_ruc:null,obs_dni:null,ruc:p.query.ruc||null});k("formState",e),k("loadingStates",s),k("loadingSubmit",u);const n=S([{type:"title",label:"Datos de la Empresa",md:12},{type:"search",label:"Número de RUC",model:"ruc",required:!0,max:11,disabled:!1},{type:"text",label:"Razón Social",model:"razonSocial",required:!0,disabled:!0},{type:"select",label:"Sector Económico",model:"economicsector_id",required:!0,options:[],disabled:!1},{type:"select",label:"Rubro",model:"rubro_id",required:!0,options:[],disabled:!1},{type:"select",label:"Actividad Comercial",model:"comercialactivity_id",required:!0,options:[],disabled:!1},{type:"select",label:"Región",model:"city_id",required:!0,options:[],disabled:!1},{type:"select",label:"Provincia",model:"province_id",required:!0,options:[],disabled:!1},{type:"select",label:"Distrito",model:"district_id",required:!0,options:[],disabled:!1},{type:"title",label:"Datos del Participante",md:12},{type:"select",label:"Tipo de documento",model:"typedocument_id",required:!0,options:[]},{type:"search",label:"Número de Documento",model:"documentnumber",required:!0,max:8,disabled:!1},{type:"text",label:"Apellido Paterno",model:"lastname",required:!0,disabled:!0},{type:"text",label:"Apellido Materno",model:"middlename",required:!0,disabled:!0},{type:"text",label:"Nombres",model:"name",required:!0,disabled:!0},{type:"select",label:"País de nacimiento",model:"country_id",required:!0,options:[]},{type:"date",label:"Fecha de nacimiento",model:"birthday",required:!0},{type:"select",label:"Género",model:"gender_id",required:!0,options:[]},{type:"select",label:"¿Tiene alguna discapacidad?",model:"sick",required:!0,options:[{label:"SI",value:"si"},{label:"NO",value:"no"}]},{type:"select",label:"Nivel educativo",model:"academicdegree_id",required:!0,options:[]},{type:"select",label:"Estado civil",model:"civil_status_id",required:!0,options:[]},{type:"number",label:"Cantidad de hijos",model:"num_soons",required:!0,max:3,minLength:0},{type:"number",label:"Número de celular",model:"phone",required:!0,max:9,minLength:9},{type:"email",label:"Correo electrónico",model:"email",required:!0},{type:"select",label:"Cargo en la empresa",model:"role_company_id",required:!0,options:[]},{type:"checkbox",label:'Autorizo la participación y el uso de mis datos personales e imagen para fines institucionales del Programa Nacional "Tu Empresa", según la Ley N.º 29733',model:"autorization",required:!0,md:12,rows:3}]);re(y,i=>{w.global.name.value=i?"dark":"light"});const F=i=>{const t=n.find(a=>a.model===i);o.value==1&&i=="ruc"&&(t.disabled=!t.disabled,M()),i=="documentnumber"&&E()},M=()=>{e.ruc=null,e.razonSocial=null,e.economicsector_id=null,e.rubro_id=null,e.comercialactivity_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.obs_ruc=null},E=()=>{e.typedocument_id=null,e.documentnumber=null,e.name=null,e.lastname=null,e.middlename=null,e.country_id=null,e.birthday=null,e.gender_id=null,e.sick=null,e.academicdegree_id=null,e.civil_status_id=null,e.num_soons=0,e.role_company_id=null,e.obs_dni=null,e.phone=null,e.email=null},j=async(i,t)=>{if(i.model=="rubro_id"){e.comercialactivity_id=null;const a=await _({url:`select/activity-by-rubro/${i.value}`,method:"GET"}),l=n.find(f=>f.model==="comercialactivity_id");l.options=a.data}if(i.model=="city_id"){e.province_id=null,e.district_id=null;const a=`select/provinces/${i.value}`;b(a,"province_id")}if(i.model=="province_id"){e.district_id=null;const a=`select/districts/${i.value}`;b(a,"district_id")}if(i.model==="typedocument_id"){const a=n.find(q=>q.model==="documentnumber");if(!a)return;const l={1:{max:8,autolockNames:!0},2:{max:9,autolockNames:!1},3:{max:12,autolockNames:!1},default:{max:9,autolockNames:!1}},f=l[i.value]||l.default;a.max=f.max,i.value&&E(),["name","lastname","middlename"].forEach(q=>{const R=n.find(W=>W.model===q);R&&(R.disabled=f.autolockNames)}),a.disabled=!1}if(i.model==="documentnumber"){const a=n.find(l=>l.model==="documentnumber");a&&(a.disabled=!1)}},O=async i=>{if(i=="ruc")return Y();if(i=="documentnumber")return G()},Y=async()=>{try{const i=await _({url:`mp/ruc-number/${e.ruc}`,method:"POST"});if(i.status==409&&["razonSocial"].forEach(t=>{const a=n.find(l=>l.model===t);a&&(a.disabled=!1),e.obs_ruc=1}),i.status==200){const{data:t}=i;e.razonSocial=t.social_reason,e.economicsector_id=t.economic_sector_id,e.rubro_id=t.rubro_id,await b(`select/activity-by-rubro/${t.rubro_id}`,"comercialactivity_id"),e.comercialactivity_id=t.comercial_activity_id,e.city_id=t.city_id,await b(`select/provinces/${t.city_id}`,"province_id"),e.province_id=t.province_id,await b(`select/districts/${t.province_id}`,"district_id"),e.district_id=t.district_id}s.ruc=!1}catch(i){console.log("Error: ",i)}},G=async()=>{try{const i=await _({url:`mp/dni-number/${e.documentnumber}`,method:"POST"});if(i.status==409&&["documentnumber","name","lastname","middlename"].forEach(t=>{const a=n.find(l=>l.model===t);a&&(a.disabled=!1),e.obs_dni=1}),i.status==201){const{data:t}=i;e.lastname=t.last_name,e.middlename=t.middle_name,e.name=t.names}if(i.status==200){const{data:t}=i;e.name=t.names,e.lastname=t.last_name,e.middlename=t.middle_name,e.gender_id=t.gender_id,e.sick=t.sick,e.academicdegree_id=t.academicdegree_id,e.civil_status_id=t.civil_status_id,e.num_soons=t.num_soons,e.birthday=D(t.date_of_birth).format("DD/MM/YYYY"),e.phone=t.phone,e.email=t.email,e.role_company_id=t.role_company_id,e.country_id=t.country_id}s.documentnumber=!1}catch(i){console.log("Error: ",i)}},B=async()=>{u.value=!0;const i={ruc:e.ruc,social_reason:e.razonSocial,economic_sector_id:e.economicsector_id,rubro_id:e.rubro_id,comercial_activity_id:e.comercialactivity_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,t_doc_id:e.typedocument_id,doc_number:e.documentnumber,country_id:e.country_id,date_of_birth:D(e.birthday).format("YYYY-MM-DD"),names:e.name,last_name:e.lastname,middle_name:e.middlename,civil_status_id:e.civil_status_id,num_soons:e.num_soons,gender_id:e.gender_id,sick:e.sick,academicdegree_id:e.academicdegree_id,phone:e.phone,email:e.email,role_company_id:e.role_company_id,obs_ruc:e.obs_ruc,obs_dni:e.obs_dni,slug:p.params.slug};try{const t=await _({url:"mp/register-participant",method:"POST",data:i});if(console.log("Response: ",t),t.status==200&&p.query.ruc){const a={ruc:e.ruc,doc_number:e.documentnumber,slug:p.params.slug,attendance:1},l=await _({url:"mp/register-attendance",method:"POST",data:a});console.log("Response2: ",l.message)}}catch(t){console.log("Error: ",t)}finally{u.value=!1}},b=async(i,t)=>{try{const a=await _({url:i,method:"GET"}),l=n.find(f=>f.model===t);l&&a.data&&(l.options=a.data)}catch(a){console.error("Error de red:",a)}},{loadSectorEconomico:I,loadRubros:L,loadCountries:H,loadCity:U,loadTypeDocuments:Q,loadGenders:X,loadCivilStatus:Z,loadAcademicDegree:J,loadRoleCompany:K}=ae(n);return z(async()=>{await I(),await L(),await U(),await Q(),await X(),await Z(),await H(),await J(),await K(),e.country_id=155}),(i,t)=>(v(),C("div",_e,[r(ie,{colorForm:"#d41a75",fields:n,onSearchDataApi:O,onSubmit:B,onChange:j,onHandleClearSearch:F},null,8,["fields"])]))}},fe={class:"mp-header mp"},ye={style:{"line-height":"2.2",color:"#fff"}},be={class:"title",style:{"line-height":"1.3"}},ve={style:{"list-style":"none","padding-left":"0","font-size":"18px"}},he={key:0,class:"mp"},ge={key:1},xe={class:"text-center",style:{"max-width":"380px"}},je={__name:"[slug]",setup(A){te("Mujer Produce | Registro","Formulario de registro para el Evento de Producción de Mujeres","mp.ico");const w=$(),y=h(!0),s=h({}),p=async()=>{try{const u=w.params.slug,o=await _({url:`mp/info-event-public/${u}`,method:"GET"});o.status===200&&(s.value=(o==null?void 0:o.data)||{}),console.log("response",o)}catch(u){console.error("Error de red:",u)}finally{y.value=!1}};return z(async()=>{await p()}),(u,o)=>(v(),V(N,{class:"py-0",fluid:""},{default:d(()=>[r(P,{align:"center",justify:"center"},{default:d(()=>[r(T,{cols:"12",sm:"12",md:"10",lg:"8",xl:"6",class:"my-2"},{default:d(()=>[r(se,{"model-value":y.value,class:"align-center justify-center",persistent:"",scrim:""},{default:d(()=>[r(ne,{color:"#d41a75",size:"64",indeterminate:""})]),_:1},8,["model-value"]),y.value?de("",!0):(v(),V(ue,{key:0,elevation:"8",rounded:"lg"},{default:d(()=>[c("div",fe,[r(P,null,{default:d(()=>[r(T,null,{default:d(()=>[c("div",ye,[r(me,{width:100,src:ee}),c("h1",be,g(s.value.title),1),c("ul",ve,[c("li",null,[r(x,null,{default:d(()=>o[1]||(o[1]=[m("mdi-map-marker")])),_:1,__:[1]}),m(" LUGAR: "+g(s.value.place),1)]),c("li",null,[r(x,{left:""},{default:d(()=>o[2]||(o[2]=[m("mdi-calendar")])),_:1,__:[2]}),m(" FECHA: "+g(s.value.date),1)]),c("li",null,[r(x,{left:""},{default:d(()=>o[3]||(o[3]=[m("mdi-clock-time-four-outline")])),_:1,__:[3]}),m(" HORARIO: "+g(s.value.hours),1)])])])]),_:1})]),_:1})]),s.value.finished?(v(),C("div",ge,[r(N,{class:"d-flex justify-center align-center",style:{"min-height":"50vh"}},{default:d(()=>[c("div",xe,[r(x,{size:"70",color:"#d41a75",class:"mb-6"},{default:d(()=>o[4]||(o[4]=[m(" mdi-calendar-remove ")])),_:1,__:[4]}),o[6]||(o[6]=c("h2",{class:"text-h5 font-weight-medium mb-2"}," Inscripciones cerradas ",-1)),o[7]||(o[7]=c("p",{class:"text-body-2 text-medium-emphasis mb-6"}," Este evento ya no acepta nuevas inscripciones. Te invitamos a revisar otras actividades disponibles. ",-1)),r(ce,{color:"#d41a75",variant:"text",class:"text-none",onClick:o[0]||(o[0]=e=>u.$emit("go-to-events"))},{default:d(()=>o[5]||(o[5]=[m(" Ver próximos eventos ")])),_:1,__:[5]})])]),_:1})])):(v(),C("div",he,[r(pe)]))]),_:1}))]),_:1})]),_:1})]),_:1}))}};export{je as default};
