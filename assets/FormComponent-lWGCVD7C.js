import{S as ke,R as $e,al as ce,T as Ce,am as Se,j as R,r as b,s as Fe,an as xe,y as Ue,m as E,ao as Be,ap as Ie,aq as De,ar as ve,as as ge,a as m,G as X,at as Me,au as Pe,av as Re,K as Z,aw as Ae,ax as Ne,b as $,F as C,ay as Te,aj as me,az as ze,aA as Ee,O as we,aB as _e,aC as se,x as fe,f as h,o as c,w as v,N as pe,c as x,C as k,E as r,t as ue,D as P,I as de,V as ie,e as _,B as He,H as be,ak as qe,aD as Ge,J as je}from"./index-dWNYWhpY.js";import{c as I,m as Le,u as Ye}from"./index-CaSN-WZq.js";import"./httpRequest-kvSXxSoU.js";import"./dayjs.min-BtSaZe5p.js";import{a as Ve,V as ye}from"./VRow-BW3cWDhU.js";import{b as he,V as Oe}from"./VSnackbar-DSV00IUq.js";import{V as Ke}from"./VTooltip-BfCWSEzK.js";import{V as We}from"./VDialog-DrEqSYXz.js";import{V as Je,c as Qe}from"./VCard-Cj-megdD.js";import{V as Xe}from"./VForm-kRstKBy2.js";const Ze=$e({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:a=>!isNaN(parseFloat(a))},maxRows:{type:[Number,String],validator:a=>!isNaN(parseFloat(a))},suffix:String,modelModifiers:Object,...Re(),...Pe()},"VTextarea"),ea=ke()({name:"VTextarea",directives:{vIntersect:ce},inheritAttrs:!1,props:Ze(),emits:{"click:control":a=>!0,"mousedown:control":a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0,"update:rows":a=>!0},setup(a,ee){let{attrs:S,emit:F,slots:p}=ee;const n=Ce(a,"modelValue"),{isFocused:V,focus:ae,blur:H}=Se(a),{onIntersect:q}=ze(a),A=R(()=>typeof a.counterValue=="function"?a.counterValue(n.value):(n.value||"").toString().length),N=R(()=>{if(S.maxlength)return S.maxlength;if(!(!a.counter||typeof a.counter!="number"&&typeof a.counter!="string"))return a.counter}),K=b(),T=b(),G=Fe(""),z=b(),oe=R(()=>a.persistentPlaceholder||V.value||a.active);function j(){var t;z.value!==document.activeElement&&((t=z.value)==null||t.focus()),V.value||ae()}function te(t){j(),F("click:control",t)}function le(t){F("mousedown:control",t)}function ne(t){t.stopPropagation(),j(),Z(()=>{n.value="",_e(a["onClick:clear"],t)})}function re(t){var e;const o=t.target;if(n.value=o.value,(e=a.modelModifiers)!=null&&e.trim){const s=[o.selectionStart,o.selectionEnd];Z(()=>{o.selectionStart=s[0],o.selectionEnd=s[1]})}}const U=b(),D=b(Number(a.rows)),i=R(()=>["plain","underlined"].includes(a.variant));xe(()=>{a.autoGrow||(D.value=Number(a.rows))});function B(){a.autoGrow&&Z(()=>{if(!U.value||!T.value)return;const t=getComputedStyle(U.value),o=getComputedStyle(T.value.$el),e=parseFloat(t.getPropertyValue("--v-field-padding-top"))+parseFloat(t.getPropertyValue("--v-input-padding-top"))+parseFloat(t.getPropertyValue("--v-field-padding-bottom")),s=U.value.scrollHeight,d=parseFloat(t.lineHeight),f=Math.max(parseFloat(a.rows)*d+e,parseFloat(o.getPropertyValue("--v-input-control-height"))),M=parseFloat(a.maxRows)*d+e||1/0,g=Ne(s??0,f,M);D.value=Math.floor((g-e)/d),G.value=Ae(g)})}Ue(B),E(n,B),E(()=>a.rows,B),E(()=>a.maxRows,B),E(()=>a.density,B),E(D,t=>{F("update:rows",t)});let y;return E(U,t=>{t?(y=new ResizeObserver(B),y.observe(U.value)):y==null||y.disconnect()}),Be(()=>{y==null||y.disconnect()}),Ie(()=>{const t=!!(p.counter||a.counter||a.counterValue),o=!!(t||p.details),[e,s]=De(S),{modelValue:d,...f}=ve.filterProps(a),M=ge.filterProps(a);return m(ve,X({ref:K,modelValue:n.value,"onUpdate:modelValue":g=>n.value=g,class:["v-textarea v-text-field",{"v-textarea--prefixed":a.prefix,"v-textarea--suffixed":a.suffix,"v-text-field--prefixed":a.prefix,"v-text-field--suffixed":a.suffix,"v-textarea--auto-grow":a.autoGrow,"v-textarea--no-resize":a.noResize||a.autoGrow,"v-input--plain-underlined":i.value},a.class],style:a.style},e,f,{centerAffix:D.value===1&&!i.value,focused:V.value}),{...p,default:g=>{let{id:w,isDisabled:L,isDirty:Y,isReadonly:W,isValid:J}=g;return m(ge,X({ref:T,style:{"--v-textarea-control-height":G.value},onClick:te,onMousedown:le,"onClick:clear":ne,"onClick:prependInner":a["onClick:prependInner"],"onClick:appendInner":a["onClick:appendInner"]},M,{id:w.value,active:oe.value||Y.value,centerAffix:D.value===1&&!i.value,dirty:Y.value||a.dirty,disabled:L.value,focused:V.value,error:J.value===!1}),{...p,default:Q=>{let{props:{class:l,...u}}=Q;return $(C,null,[a.prefix&&$("span",{class:"v-text-field__prefix"},[a.prefix]),me($("textarea",X({ref:z,class:l,value:n.value,onInput:re,autofocus:a.autofocus,readonly:W.value,disabled:L.value,placeholder:a.placeholder,rows:a.rows,name:a.name,onFocus:j,onBlur:H},u,s),null),[[ce,{handler:q},null,{once:!0}]]),a.autoGrow&&me($("textarea",{class:we([l,"v-textarea__sizer"]),id:`${u.id}-sizer`,"onUpdate:modelValue":O=>n.value=O,ref:U,readonly:!0,"aria-hidden":"true"},null),[[Ee,n.value]]),a.suffix&&$("span",{class:"v-text-field__suffix"},[a.suffix])])}})},details:o?g=>{var w;return $(C,null,[(w=p.details)==null?void 0:w.call(p,g),t&&$(C,null,[$("span",null,null),m(Te,{active:a.persistentCounter||V.value,value:A.value,max:N.value,disabled:a.disabled},p.counter)])])}:void 0})}),Me({},K,T,z)}}),aa={key:0},oa={class:"mt-4 mb-3"},ta={key:0,class:"text-red text-caption pl-4"},la={key:8,class:"position-relative"},fa={__name:"FormComponent",props:{fields:Array,colorForm:String},emits:["submit","change","searchDataApi","handleClearSearch"],setup(a,{emit:ee}){const S=ee,F=a,p=b(null),n=se("formState");if(!n)throw new Error("❌ formState no fue proporcionado desde el componente padre.");const V=se("loadingStates"),ae=se("loadingSubmit",b(!1));b(!1),b(!1);const H=b(!1),q=b(""),A=fe({}),N=fe({}),K=R(()=>{const t=new Date;return t.setFullYear(t.getFullYear()-18),t.toISOString().split("T")[0]});function T(t){A[t]=!0}function G(t){A[t]=!1}async function z(t){const o=F.fields.find(e=>e.model===t);o.disabled=!0,V[t]=!0,S("searchDataApi",t)}const oe=t=>{S("handleClearSearch",t)},j=b(["Facebook","Instagram","TikTok","Web"]),te=R(()=>{const t=n.socials.map(o=>o.name);return j.value.filter(o=>!t.includes(o))}),le=t=>{t&&!n.socials.find(o=>o.name===t)&&n.socials.push({name:t,link:""}),p.value=null},ne=t=>{const o=n.socials.findIndex(e=>e.name===t);o!==-1&&n.socials.splice(o,1)},re={Facebook:"https://www.facebook.com/",Instagram:"https://www.instagram.com/",TikTok:"https://www.tiktok.com/@",Web:"https://www."},U=t=>{if(!t)return!0;const o=/^(\d{2})\/(\d{2})\/(\d{4})$/,e=t.match(o);if(!e)return"Formato inválido. Usa dd/mm/aaaa";const s=parseInt(e[1],10),d=parseInt(e[2],10),f=parseInt(e[3],10);if(d<1||d>12)return"Mes inválido (1-12)";const g=new Date().getFullYear()-f;if(g<18||g>100)return"Edad debe estar entre 18 y 100 años";const w=new Date(f,d,0).getDate();return s<1||s>w?`Día inválido para el mes ${d}`:!0},D=R(()=>{const t={};for(const o of F.fields){const e=[];o.required&&e.push(I.withMessage(`Es requerido: "${o.label}"`,s=>{const d=typeof o.condition=="function"?o.condition(n):!0;return o.type==="social"?!d||Array.isArray(s)&&s.length>0&&s.every(f=>f.link.trim()!==""):!d||I.req(s)})),o.max&&e.push(I.withMessage(`${o.label} debe tener máximo ${o.max} caracteres`,s=>!s||s.length<=o.max)),o.minLength&&e.push(I.withMessage(`${o.label} debe tener mínimo ${o.minLength} caracteres`,Le(o.minLength))),o.model==="ruc"&&e.push(I.withMessage("Número de RUC no válido",s=>{if(!s)return!o.required;const d=String(s);return d.length===11&&["10","15","20"].includes(d.substring(0,2))})),o.model==="documentnumber"&&e.push(I.withMessage("Número de documento no válido",s=>{if(!s)return!1;const d=String(s);return n.typedocument_id===1?/^\d{8}$/.test(d):[2,3,4,5].includes(n.typedocument_id)?/^\d{1,12}$/.test(d):!1})),o.model==="phone"&&e.push(I.withMessage("Número de celular inválido",s=>{const d=String(s||"");return/^9\d{8}$/.test(d)})),o.model==="email"&&e.push(I.withMessage("Ingresa un correo válido",s=>s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s):!o.required)),t[o.model]=e}return t}),i=Ye(D,n),B=(t,o)=>{S("change",{value:t,model:o},o)},y=async()=>{try{if(await i.value.$validate())S("submit");else{const o=F.fields.find(e=>{var s;return(s=i.value[e.model])==null?void 0:s.$invalid});o?(q.value=`Completa el campo "${o.label}"`,Z(()=>{const e=document.querySelector(`[data-model="${o.model}"]`);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.focus())})):q.value="Corrige los errores del formulario",H.value=!0}}catch(t){console.error("Error en handleSubmit:",t)}};return xe(()=>{F.fields.forEach(t=>{if(t.type==="date"){const o=n[t.model];if(!o){N[t.model]="";return}const e=new Date(o),s=String(e.getDate()).padStart(2,"0"),d=String(e.getMonth()+1).padStart(2,"0"),f=e.getFullYear();N[t.model]=`${s}/${d}/${f}`}})}),(t,o)=>(c(),h(C,null,[m(Xe,{onSubmit:be(y,["prevent"])},{default:v(()=>[m(Ve,null,{default:v(()=>[(c(!0),h(C,null,pe(a.fields,e=>(c(),x(ye,{key:e.model,cols:e.cols||12,md:e.md||6,class:we(e.py||"py-1")},{default:v(()=>{var s,d,f,M,g,w,L,Y,W,J,Q;return[!e.condition||e.condition(r(n))?(c(),h(C,{key:0},[e.type==="title"?(c(),h("div",aa,[$("h4",oa,ue(e.label),1)])):k("",!0),e.type==="text"?(c(),x(P,{key:1,label:e.label,modelValue:r(n)[e.model],"onUpdate:modelValue":l=>r(n)[e.model]=l,color:a.colorForm,"data-model":e.model,density:"comfortable",variant:"outlined","error-messages":(s=r(i)[e.model])==null?void 0:s.$errors.map(l=>l.$message),disabled:e.disabled,onBlur:l=>{var u;return(u=r(i)[e.model])==null?void 0:u.$touch()}},null,8,["label","modelValue","onUpdate:modelValue","color","data-model","error-messages","disabled","onBlur"])):k("",!0),e.type==="textarea"?(c(),x(ea,{key:2,label:e.label,modelValue:r(n)[e.model],"onUpdate:modelValue":l=>r(n)[e.model]=l,rows:e.rows||2,color:a.colorForm,"data-model":e.model,density:"comfortable",variant:"outlined","error-messages":(d=r(i)[e.model])==null?void 0:d.$errors.map(l=>l.$message),disabled:e.disabled,onBlur:l=>{var u;return(u=r(i)[e.model])==null?void 0:u.$touch()}},null,8,["label","modelValue","onUpdate:modelValue","rows","color","data-model","error-messages","disabled","onBlur"])):e.type==="select"?(c(),x(he,{key:3,label:e.label,items:e.options,"onUpdate:modelValue":[l=>B(l,e.model),l=>r(n)[e.model]=l],"data-model":e.model,"item-title":"label","item-value":"value",color:a.colorForm,density:"comfortable",variant:"outlined",disabled:e.disabled,"menu-props":{scrim:!0,scrollStrategy:"close"},modelValue:r(n)[e.model],"error-messages":(f=r(i)[e.model])==null?void 0:f.$errors.map(l=>l.$message),onBlur:l=>{var u;return(u=r(i)[e.model])==null?void 0:u.$touch()}},null,8,["label","items","onUpdate:modelValue","data-model","color","disabled","modelValue","error-messages","onBlur"])):e.type==="social"?(c(),h(C,{key:4},[m(he,{modelValue:p.value,"onUpdate:modelValue":[o[0]||(o[0]=l=>p.value=l),le],label:e.label,items:te.value,"data-model":e.model,density:"comfortable",color:a.colorForm,variant:"outlined","menu-props":{scrim:!0,scrollStrategy:"close"},placeholder:"Selecciona una red","hide-details":"",class:""},null,8,["modelValue","label","items","data-model","color"]),(M=r(i).socials)!=null&&M.$error?(c(),h("span",ta,ue((w=(g=r(i).socials)==null?void 0:g.$errors[0])==null?void 0:w.$message),1)):k("",!0)],64)):e.type==="redes"?(c(!0),h(C,{key:5},pe(r(n).socials,(l,u)=>(c(),h("div",{key:l.name,class:"d-flex align-start",style:{gap:".5rem"}},[m(P,{label:`Link de ${l.name}`,prefix:re[l.name],density:"comfortable","data-model":e.model,color:a.colorForm,variant:"outlined",modelValue:r(n).socials[u].link,"onUpdate:modelValue":O=>r(n).socials[u].link=O},null,8,["label","prefix","data-model","color","modelValue","onUpdate:modelValue"]),m(de,{icon:"",size:"30",color:"red",class:"mt-2",onClick:O=>ne(l.name)},{default:v(()=>[m(ie,{size:"18"},{default:v(()=>o[4]||(o[4]=[_("mdi-close")])),_:1,__:[4]})]),_:2},1032,["onClick"])]))),128)):k("",!0),e.type==="number"?(c(),x(P,{key:6,label:e.label,modelValue:r(n)[e.model],"onUpdate:modelValue":l=>r(n)[e.model]=l,"data-model":e.model,color:a.colorForm,density:"comfortable",variant:"outlined",counter:e.max,maxlength:e.max,inputmode:"numeric",pattern:"[0-9]*",onKeypress:o[1]||(o[1]=l=>!/[0-9]/.test(l.key)&&l.preventDefault()),"error-messages":(L=r(i)[e.model])==null?void 0:L.$errors.map(l=>l.$message),onBlur:l=>{var u;return(u=r(i)[e.model])==null?void 0:u.$touch()}},null,8,["label","modelValue","onUpdate:modelValue","data-model","color","counter","maxlength","error-messages","onBlur"])):k("",!0),e.type==="email"?(c(),x(P,{key:7,label:e.label,modelValue:r(n)[e.model],"onUpdate:modelValue":l=>r(n)[e.model]=l,"data-model":e.model,color:a.colorForm,density:"comfortable",variant:"outlined",type:"email",autocomplete:"email","error-messages":(Y=r(i)[e.model])==null?void 0:Y.$errors.map(l=>l.$message),onBlur:l=>{var u;return(u=r(i)[e.model])==null?void 0:u.$touch()}},null,8,["label","modelValue","onUpdate:modelValue","data-model","color","error-messages","onBlur"])):k("",!0),e.type==="search"?(c(),h("div",la,[m(P,{label:e.label,modelValue:r(n)[e.model],"onUpdate:modelValue":l=>r(n)[e.model]=l,disabled:e.disabled,"data-model":e.model,color:a.colorForm,density:"comfortable",variant:"outlined",counter:e.max,maxlength:e.max,inputmode:"numeric",pattern:"[0-9]*",loading:r(V)[e.model],"error-messages":(W=r(i)[e.model])==null?void 0:W.$errors.map(l=>l.$message),onBlur:l=>{var u;return(u=r(i)[e.model])==null?void 0:u.$touch()}},{"append-inner":v(()=>[m(Ke,{text:"Click para buscar",location:"top"},{activator:v(({props:l})=>{var u;return[r(V)[e.model]?(c(),x(He,{key:0,indeterminate:"",color:"primary",size:"20",class:"me-2"})):me((c(),x(ie,X({key:1,ref_for:!0},l,{class:"me-2 input-search",onMousedown:o[2]||(o[2]=be(()=>{},["prevent"])),onClick:O=>z(e.model)}),{default:v(()=>o[5]||(o[5]=[_(" mdi-magnify ")])),_:2,__:[5]},1040,["onClick"])),[[qe,String(r(n)[e.model]||"").length===e.max&&!((u=r(i)[e.model])!=null&&u.$invalid)&&!r(V)[e.model]]])]}),_:2},1024)]),_:2},1032,["label","modelValue","onUpdate:modelValue","disabled","data-model","color","counter","maxlength","loading","error-messages","onBlur"]),e.disabled?(c(),x(ie,{key:0,class:"icon-clear-field",onClick:l=>oe(e.model)},{default:v(()=>o[6]||(o[6]=[_("mdi-window-close")])),_:2,__:[6]},1032,["onClick"])):k("",!0)])):e.type==="dateCalendar"?(c(),h(C,{key:9},[m(P,{label:e.label,modelValue:N[e.model],"onUpdate:modelValue":l=>N[e.model]=l,density:"comfortable","data-model":e.model,color:a.colorForm,variant:"outlined",onClick:l=>T(e.model),"error-messages":(J=r(i)[e.model])==null?void 0:J.$errors.map(l=>l.$message),onBlur:l=>{var u;return(u=r(i)[e.model])==null?void 0:u.$touch()}},null,8,["label","modelValue","onUpdate:modelValue","data-model","color","onClick","error-messages","onBlur"]),m(We,{modelValue:A[e.model],"onUpdate:modelValue":l=>A[e.model]=l,width:"auto"},{default:v(()=>[m(Je,null,{default:v(()=>[m(Ge,{modelValue:r(n)[e.model],"onUpdate:modelValue":[l=>r(n)[e.model]=l,()=>G(e.model)],max:K.value,color:"primary"},null,8,["modelValue","onUpdate:modelValue","max"]),m(Qe,null,{default:v(()=>[m(je),m(de,{text:"",onClick:l=>G(e.model)},{default:v(()=>o[7]||(o[7]=[_("Cancelar")])),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):e.type==="date"?(c(),x(P,{key:10,modelValue:r(n)[e.model],"onUpdate:modelValue":l=>r(n)[e.model]=l,label:e.label,placeholder:"día/mes/año",maxlength:"10",outlined:"",clearable:"",density:"comfortable","data-model":e.model,color:a.colorForm,variant:"outlined",rules:[U],"error-messages":(Q=r(i)[e.model])==null?void 0:Q.$errors.map(l=>l.$message)},null,8,["modelValue","onUpdate:modelValue","label","data-model","color","rules","error-messages"])):k("",!0)],64)):k("",!0)]}),_:2},1032,["cols","md","class"]))),128))]),_:1}),m(Ve,{justify:"center",class:"mt-8"},{default:v(()=>[m(ye,{cols:"12",md:"6",class:"d-flex justify-center"},{default:v(()=>[m(de,{type:"submit",color:a.colorForm,class:"btn-submit",size:"large",elevation:"2",loading:r(ae)},{default:v(()=>o[8]||(o[8]=[_(" Enviar ")])),_:1,__:[8]},8,["color","loading"])]),_:1})]),_:1})]),_:1}),m(Oe,{modelValue:H.value,"onUpdate:modelValue":o[3]||(o[3]=e=>H.value=e),timeout:4e3,color:"red",location:"top"},{default:v(()=>[_(ue(q.value),1)]),_:1},8,["modelValue"])],64))}};export{fa as _};
