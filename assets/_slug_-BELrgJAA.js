import{_ as ie}from"./mp-logo-CPdgfx02.js";import{u as ae}from"./usePageMeta-zMl3s0mq.js";import{h as _}from"./httpRequest-D3KC4pOG.js";import{_ as oe}from"./FormComponent-e6v1kZmq.js";import{u as le}from"./useFormOptions-BD_ZbAMu.js";import{L as re,r as b,i as E,u as A,k as se,H as de,o as F,c as q,b as p,e as r,M as R,f as V,w as s,m as ne,j as ce,l as me,d as l,t as k,g as n,V as x,y as D}from"./index-DMaMMhca.js";import{d as ue}from"./VDialog-7lCwSEQ-.js";import{V as P}from"./VContainer-68tcl0eq.js";import{a as $,V as z}from"./VRow-BkKfwfjD.js";import{V as _e}from"./VCard-D3YP5q9o.js";import{V as pe}from"./VAvatar-cHfdZKxR.js";import"./index-REPG1qtP.js";import"./VSnackbar-jputXAJ1.js";import"./VList-BWJlotLM.js";import"./VForm-CtPtkXXQ.js";const fe={class:"mp-form"},ye={__name:"MujerProduceForm",emits:["registered"],setup(j,{emit:w}){const S=w,v=re(),u=b(!1),h=E({}),f=A();se();const c=b(!1),a=b(1),e=E({num_soons:0,obs_ruc:null,obs_dni:null,ruc:f.query.ruc||null});R("formState",e),R("loadingStates",h),R("loadingSubmit",c);const m=E([{type:"title",label:"Datos de la Empresa",md:12},{type:"search",label:"Número de RUC",model:"ruc",required:!0,max:11,disabled:!1},{type:"text",label:"Razón Social",model:"razonSocial",required:!0,disabled:!0},{type:"select",label:"Sector Económico",model:"economicsector_id",required:!0,options:[],disabled:!1},{type:"select",label:"Rubro",model:"rubro_id",required:!0,options:[],disabled:!1},{type:"select",label:"Actividad Comercial",model:"comercialactivity_id",required:!0,options:[],disabled:!1},{type:"select",label:"Región",model:"city_id",required:!0,options:[],disabled:!1},{type:"select",label:"Provincia",model:"province_id",required:!0,options:[],disabled:!1},{type:"select",label:"Distrito",model:"district_id",required:!0,options:[],disabled:!1},{type:"title",label:"Datos del Participante",md:12},{type:"select",label:"Tipo de documento",model:"typedocument_id",required:!0,options:[]},{type:"search",label:"Número de Documento",model:"documentnumber",required:!0,max:8,disabled:!1},{type:"text",label:"Apellido Paterno",model:"lastname",required:!0,disabled:!0},{type:"text",label:"Apellido Materno",model:"middlename",required:!0,disabled:!0},{type:"text",label:"Nombres",model:"name",required:!0,disabled:!0},{type:"select",label:"País de nacimiento",model:"country_id",required:!0,options:[]},{type:"date",label:"Fecha de nacimiento",model:"birthday",required:!0},{type:"select",label:"Género",model:"gender_id",required:!0,options:[]},{type:"select",label:"¿Tiene alguna discapacidad?",model:"sick",required:!0,options:[{label:"SI",value:"si"},{label:"NO",value:"no"}]},{type:"select",label:"Nivel educativo",model:"academicdegree_id",required:!0,options:[]},{type:"select",label:"Estado civil",model:"civil_status_id",required:!0,options:[]},{type:"number",label:"Cantidad de hijos",model:"num_soons",required:!0,max:3,minLength:0},{type:"number",label:"Número de celular",model:"phone",required:!0,max:9,minLength:9},{type:"email",label:"Correo electrónico",model:"email",required:!0},{type:"select",label:"Cargo en la empresa",model:"role_company_id",required:!0,options:[]},{type:"checkbox",label:'Autorizo la participación y el uso de mis datos personales e imagen para fines institucionales del Programa Nacional "Tu Empresa", según la Ley N.º 29733',model:"autorization",required:!0,md:12,rows:3}]);de(u,i=>{v.global.name.value=i?"dark":"light"});const M=i=>{const t=m.find(o=>o.model===i);a.value==1&&i=="ruc"&&(t.disabled=!t.disabled,O()),i=="documentnumber"&&N()},O=()=>{e.ruc=null,e.razonSocial=null,e.economicsector_id=null,e.rubro_id=null,e.comercialactivity_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.obs_ruc=null},N=()=>{e.typedocument_id=null,e.documentnumber=null,e.name=null,e.lastname=null,e.middlename=null,e.country_id=null,e.birthday=null,e.gender_id=null,e.sick=null,e.academicdegree_id=null,e.civil_status_id=null,e.num_soons=0,e.role_company_id=null,e.obs_dni=null,e.phone=null,e.email=null},G=async(i,t)=>{if(i.model=="rubro_id"){e.comercialactivity_id=null;const o=await _({url:`select/activity-by-rubro/${i.value}`,method:"GET"}),d=m.find(y=>y.model==="comercialactivity_id");d.options=o.data}if(i.model=="city_id"){e.province_id=null,e.district_id=null;const o=`select/provinces/${i.value}`;g(o,"province_id")}if(i.model=="province_id"){e.district_id=null;const o=`select/districts/${i.value}`;g(o,"district_id")}if(i.model==="typedocument_id"){const o=m.find(C=>C.model==="documentnumber");if(!o)return;const d={1:{max:8,autolockNames:!0},2:{max:9,autolockNames:!1},3:{max:12,autolockNames:!1},default:{max:9,autolockNames:!1}},y=d[i.value]||d.default;o.max=y.max,i.value&&N(),["name","lastname","middlename"].forEach(C=>{const T=m.find(te=>te.model===C);T&&(T.disabled=y.autolockNames)}),o.disabled=!1}if(i.model==="documentnumber"){const o=m.find(d=>d.model==="documentnumber");o&&(o.disabled=!1)}},I=async i=>{if(i=="ruc")return L();if(i=="documentnumber")return B()},L=async()=>{try{const i=await _({url:`mp/ruc-number/${e.ruc}`,method:"POST"});if(i.status==409&&["razonSocial"].forEach(t=>{const o=m.find(d=>d.model===t);o&&(o.disabled=!1),e.obs_ruc=1}),i.status==200){const{data:t}=i;e.razonSocial=t.social_reason,e.economicsector_id=t.economic_sector_id,e.rubro_id=t.rubro_id,await g(`select/activity-by-rubro/${t.rubro_id}`,"comercialactivity_id"),e.comercialactivity_id=t.comercial_activity_id,e.city_id=t.city_id,await g(`select/provinces/${t.city_id}`,"province_id"),e.province_id=t.province_id,await g(`select/districts/${t.province_id}`,"district_id"),e.district_id=t.district_id}h.ruc=!1}catch(i){console.log("Error: ",i)}},B=async()=>{try{const i=await _({url:`mp/dni-number/${e.documentnumber}`,method:"POST"});if(i.status==409&&["documentnumber","name","lastname","middlename"].forEach(t=>{const o=m.find(d=>d.model===t);o&&(o.disabled=!1),e.obs_dni=1}),i.status==201){const{data:t}=i;e.lastname=t.last_name,e.middlename=t.middle_name,e.name=t.names}if(i.status==200){const{data:t}=i;e.name=t.names,e.lastname=t.last_name,e.middlename=t.middle_name,e.gender_id=t.gender_id,e.sick=t.sick,e.academicdegree_id=t.academicdegree_id,e.civil_status_id=t.civil_status_id,e.num_soons=t.num_soons,e.birthday=ue(t.date_of_birth).format("DD/MM/YYYY"),e.phone=t.phone,e.email=t.email,e.role_company_id=t.role_company_id,e.country_id=t.country_id}h.documentnumber=!1}catch(i){console.log("Error: ",i)}},U=async()=>{c.value=!0;const i={ruc:e.ruc,social_reason:e.razonSocial,economic_sector_id:e.economicsector_id,rubro_id:e.rubro_id,comercial_activity_id:e.comercialactivity_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,t_doc_id:e.typedocument_id,doc_number:e.documentnumber,country_id:e.country_id,date_of_birth:e.birthday,names:e.name,last_name:e.lastname,middle_name:e.middlename,civil_status_id:e.civil_status_id,num_soons:e.num_soons,gender_id:e.gender_id,sick:e.sick,academicdegree_id:e.academicdegree_id,phone:e.phone,email:e.email,role_company_id:e.role_company_id,obs_ruc:e.obs_ruc,obs_dni:e.obs_dni,slug:f.params.slug};try{const t=await _({url:"mp/register-participant",method:"POST",data:i});if(t.status==200){if(f.query.ruc){const o={ruc:e.ruc,doc_number:e.documentnumber,slug:f.params.slug,attendance:1},d=await _({url:"mp/register-attendance",method:"POST",data:o})}setTimeout(()=>{S("registered",t)},700)}}catch(t){console.log("Error: ",t)}finally{c.value=!1}},g=async(i,t)=>{try{const o=await _({url:i,method:"GET"}),d=m.find(y=>y.model===t);d&&o.data&&(d.options=o.data)}catch(o){console.error("Error de red:",o)}},{loadSectorEconomico:Y,loadRubros:H,loadCountries:K,loadCity:Q,loadTypeDocuments:W,loadGenders:J,loadCivilStatus:X,loadAcademicDegree:Z,loadRoleCompany:ee}=le(m);return F(async()=>{await Y(),await H(),await Q(),await W(),await J(),await X(),await K(),await Z(),await ee(),e.country_id=155}),(i,t)=>(p(),q("div",fe,[r(oe,{colorForm:"#d41a75",fields:m,onSearchDataApi:I,onSubmit:U,onChange:G,onHandleClearSearch:M},null,8,["fields"])]))}},be={class:"mp-header mp"},ve={style:{"line-height":"2.2",color:"#fff"}},he={class:"title",style:{"line-height":"1.3"}},ge={style:{"list-style":"none","padding-left":"0","font-size":"18px"}},xe={key:0,class:"mp"},we={key:1,class:"text-center"},ke={class:"d-flex justify-center align-center"},qe={class:"text-center pa-8",style:{"max-width":"420px",width:"100%"}},Se={key:1},Ce={class:"text-center",style:{"max-width":"380px"}},Ie={__name:"[slug]",setup(j){ae("Mujer Produce | Registro","Formulario de registro para el Evento de Producción de Mujeres","mp.ico");const w=b(!0),S=A(),v=b(!0),u=b({}),h=c=>{c&&(w.value=!1)},f=async()=>{try{const c=S.params.slug,a=await _({url:`mp/info-event-public/${c}`,method:"GET"});a.status===200&&(u.value=(a==null?void 0:a.data)||{}),console.log("response",a)}catch(c){console.error("Error de red:",c)}finally{v.value=!1}};return F(async()=>{await f()}),(c,a)=>(p(),V(P,{class:"py-0",fluid:""},{default:s(()=>[r($,{align:"center",justify:"center"},{default:s(()=>[r(z,{cols:"12",sm:"12",md:"10",lg:"8",xl:"6",class:"my-2"},{default:s(()=>[r(ce,{"model-value":v.value,class:"align-center justify-center",persistent:"",scrim:""},{default:s(()=>[r(me,{color:"#d41a75",size:"64",indeterminate:""})]),_:1},8,["model-value"]),v.value?ne("",!0):(p(),V(_e,{key:0,elevation:"8",rounded:"lg"},{default:s(()=>[l("div",be,[r($,null,{default:s(()=>[r(z,null,{default:s(()=>[l("div",ve,[r(pe,{width:100,src:ie}),l("h1",he,k(u.value.title),1),l("ul",ge,[l("li",null,[r(x,null,{default:s(()=>a[1]||(a[1]=[n("mdi-map-marker")])),_:1,__:[1]}),n(" LUGAR: "+k(u.value.place),1)]),l("li",null,[r(x,{left:""},{default:s(()=>a[2]||(a[2]=[n("mdi-calendar")])),_:1,__:[2]}),n(" FECHA: "+k(u.value.date),1)]),l("li",null,[r(x,{left:""},{default:s(()=>a[3]||(a[3]=[n("mdi-clock-time-four-outline")])),_:1,__:[3]}),n(" HORARIO: "+k(u.value.hours),1)])])])]),_:1})]),_:1})]),u.value.finished?(p(),q("div",Se,[r(P,{class:"d-flex justify-center align-center",style:{"min-height":"50vh"}},{default:s(()=>[l("div",Ce,[r(x,{size:"70",color:"#d41a75",class:"mb-6"},{default:s(()=>a[9]||(a[9]=[n(" mdi-calendar-remove ")])),_:1,__:[9]}),a[11]||(a[11]=l("h2",{class:"text-h5 font-weight-medium mb-2"}," Inscripciones cerradas ",-1)),a[12]||(a[12]=l("p",{class:"text-body-2 text-medium-emphasis mb-6"}," Este evento ya no acepta nuevas inscripciones. Te invitamos a revisar otras actividades disponibles. ",-1)),r(D,{color:"#d41a75",variant:"text",class:"text-none",onClick:a[0]||(a[0]=e=>c.$emit("go-to-events"))},{default:s(()=>a[10]||(a[10]=[n(" Ver próximos eventos ")])),_:1,__:[10]})])]),_:1})])):(p(),q("div",xe,[w.value?(p(),V(ye,{key:0,onRegistered:h})):(p(),q("div",we,[l("div",ke,[l("div",qe,[r(x,{size:"80",color:"success",class:"mb-4"},{default:s(()=>a[4]||(a[4]=[n(" mdi-check-circle-outline ")])),_:1,__:[4]}),a[6]||(a[6]=l("h2",{class:"text-h5 font-weight-semibold mb-2"}," ¡Registro confirmado! ",-1)),a[7]||(a[7]=l("p",{class:"text-body-1 text-medium-emphasis mb-6"},[n(" Gracias por registrarte a este evento."),l("br"),n(" Te esperamos el día del evento. ")],-1)),r(D,{color:"success",size:"large",rounded:"pill",class:"text-none font-weight-medium mb-3",block:"","prepend-icon":"mdi-whatsapp",href:"https://chat.whatsapp.com/TU_LINK_AQUI",target:"_blank"},{default:s(()=>a[5]||(a[5]=[n(" Unirme al grupo de WhatsApp ")])),_:1,__:[5]}),a[8]||(a[8]=l("p",{class:"text-caption text-medium-emphasis"}," Ya estás registrado. Únete al grupo para recibir avisos e información importante. ",-1))])])]))]))]),_:1}))]),_:1})]),_:1})]),_:1}))}};export{Ie as default};
