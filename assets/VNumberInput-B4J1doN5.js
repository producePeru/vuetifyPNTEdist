import{a4 as ie,g as re,p as oe,r as ce,aV as se,h as x,s as j,A as de,aJ as z,aE as ve,t as F,w as fe,o as me,l as pe,a9 as J,j as N,i as v,F as A,B as Ne,V as W,D as Y,aH as be,aB as ge,aW as we,N as he,aX as Pe}from"./index-Bu4Cpz4J.js";import{f as B}from"./VSnackbar-B5Gp_9CG.js";const Ve=50,xe=500;function De(n){let{toggleUpDown:M}=n,l=-1,m=-1;ie(c);function D(a){c(),g(a),window.addEventListener("pointerup",c),document.addEventListener("blur",c),l=window.setTimeout(()=>{m=window.setInterval(()=>g(a),Ve)},xe)}function c(){window.clearTimeout(l),window.clearInterval(m),window.removeEventListener("pointerup",c),document.removeEventListener("blur",c)}function g(a){M(a==="up")}return{holdStart:D,holdStop:c}}const Ie=oe({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},...ge(we(),["modelValue","validationValue"])},"VNumberInput"),Ce=re()({name:"VNumberInput",props:{...Ie()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,M){let{slots:l}=M;const m=ce(),{holdStart:D,holdStop:c}=De({toggleUpDown:U}),g=se(n),a=x(()=>g.isDisabled.value||g.isReadonly.value),I=j(n.focused);function w(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision;const r=t==null?String(e):e.toFixed(t);return I.value?Number(r).toString():r}const u=de(n,"modelValue",null,e=>e??null,e=>e==null?e??null:z(Number(e),n.min,n.max)),h=j(null);ve(()=>{I.value&&!a.value||(u.value==null?h.value=null:isNaN(u.value)||(h.value=w(u.value)))});const o=x({get:()=>h.value,set(e){e===null||e===""?(u.value=null,h.value=null):!isNaN(Number(e))&&Number(e)<=n.max&&Number(e)>=n.min&&(u.value=Number(e),h.value=e)}}),R=x(()=>a.value?!1:(u.value??0)+n.step<=n.max),L=x(()=>a.value?!1:(u.value??0)-n.step>=n.min),i=x(()=>n.hideInput?"stacked":n.controlVariant),H=F(()=>i.value==="split"?"$plus":"$collapse"),$=F(()=>i.value==="split"?"$minus":"$expand"),E=F(()=>i.value==="split"?"default":"small"),y=F(()=>i.value==="stacked"?"auto":"100%"),Z={props:{onClick:C,onPointerup:f,onPointerdown:O,onPointercancel:f}},q={props:{onClick:C,onPointerup:f,onPointerdown:G,onPointercancel:f}};fe(()=>n.precision,()=>ne()),me(()=>{_()});function K(e){if(e==null)return 0;const t=e.toString(),r=t.indexOf(".");return~r?t.length-r:0}function U(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(a.value)return;if(u.value==null){o.value=w(z(0,n.min,n.max));return}let t=Math.max(K(u.value),K(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?R.value&&(o.value=w(u.value+n.step,t)):L.value&&(o.value=w(u.value-n.step,t))}function Q(e){var k;if(!e.data)return;const t=e.target,{value:r,selectionStart:S,selectionEnd:T}=t??{},p=r?r.slice(0,S)+e.data+r.slice(T):e.data,b=Pe(p,n.precision);/^-?(\d+(\.\d*)?|(\.\d+)|\d*|\.)$/.test(p)||(e.preventDefault(),t.value=b),n.precision!=null&&(((k=p.split(".")[1])==null?void 0:k.length)>n.precision&&(e.preventDefault(),t.value=b),n.precision===0&&p.includes(".")&&(e.preventDefault(),t.value=b))}async function ee(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),_(),await he(),e.key==="ArrowDown"?U(!1):U())}function C(e){e.stopPropagation()}function f(e){const t=e.currentTarget;t==null||t.releasePointerCapture(e.pointerId),e.preventDefault(),c()}function O(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),D("up")}function G(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),D("down")}function _(){if(a.value||!m.value)return;const e=m.value.value;e&&!isNaN(Number(e))?o.value=w(z(Number(e),n.min,n.max)):o.value=null}function ne(){if(!a.value){if(u.value===null||isNaN(u.value)){o.value=null;return}o.value=n.precision==null?String(u.value):u.value.toFixed(n.precision)}}function te(){if(!a.value){if(u.value===null||isNaN(u.value)){o.value=null;return}o.value=u.value.toString()}}function ue(){te()}function le(){_()}return pe(()=>{const{modelValue:e,...t}=J.filterProps(n);function r(){return l.increment?v(Y,{key:"increment-defaults",defaults:{VBtn:{disabled:!R.value,flat:!0,height:y.value,size:E.value,icon:H.value}}},{default:()=>[l.increment(Z)]}):v(W,{"aria-hidden":"true","data-testid":"increment",disabled:!R.value,flat:!0,height:y.value,icon:H.value,key:"increment-btn",onClick:C,onPointerdown:O,onPointerup:f,onPointercancel:f,size:E.value,tabindex:"-1"},null)}function S(){return l.decrement?v(Y,{key:"decrement-defaults",defaults:{VBtn:{disabled:!L.value,flat:!0,height:y.value,size:E.value,icon:$.value}}},{default:()=>[l.decrement(q)]}):v(W,{"aria-hidden":"true","data-testid":"decrement",disabled:!L.value,flat:!0,height:y.value,icon:$.value,key:"decrement-btn",onClick:C,onPointerdown:G,onPointerup:f,onPointercancel:f,size:E.value,tabindex:"-1"},null)}function T(){return N("div",{class:"v-number-input__control"},[S(),v(B,{vertical:i.value!=="stacked"},null),r()])}function p(){return!n.hideInput&&!n.inset?v(B,{vertical:!0},null):void 0}const b=i.value==="split"?N("div",{class:"v-number-input__control"},[v(B,{vertical:!0},null),r()]):n.reverse||i.value==="hidden"?void 0:N(A,null,[p(),T()]),k=l["append-inner"]||b,X=i.value==="split"?N("div",{class:"v-number-input__control"},[S(),v(B,{vertical:!0},null)]):n.reverse&&i.value!=="hidden"?N(A,null,[T(),p()]):void 0,ae=l["prepend-inner"]||X;return v(J,Ne({ref:m},t,{modelValue:o.value,"onUpdate:modelValue":s=>o.value=s,focused:I.value,"onUpdate:focused":s=>I.value=s,validationValue:u.value,onBeforeinput:Q,onFocus:ue,onBlur:le,onKeydown:ee,class:["v-number-input",{"v-number-input--default":i.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":i.value==="split","v-number-input--stacked":i.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...l,"append-inner":k?function(){var V;for(var s=arguments.length,P=new Array(s),d=0;d<s;d++)P[d]=arguments[d];return N(A,null,[(V=l["append-inner"])==null?void 0:V.call(l,...P),b])}:void 0,"prepend-inner":ae?function(){var V;for(var s=arguments.length,P=new Array(s),d=0;d<s;d++)P[d]=arguments[d];return N(A,null,[X,(V=l["prepend-inner"])==null?void 0:V.call(l,...P)])}:void 0})}),be({},m)}});export{Ce as V};
