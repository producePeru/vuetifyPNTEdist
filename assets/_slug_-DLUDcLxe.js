import{u as L}from"./usePageMeta-DJqFmFkG.js";import{h as $}from"./httpRequest-D3KC4pOG.js";import{_ as Y}from"./FormComponent-BMD4MXQv.js";import{u as Z}from"./useFormOptions-BD_ZbAMu.js";import{L as J,r as f,i as V,u as F,k as K,H as Q,o as T,c as w,b as h,e as s,w as o,d as n,V as g,g as i,t as p,M as k,f as D,m as W,j as X,l as ee,y as te}from"./index-3ZS4mmbk.js";import"./VDialog-DSVGdQAF.js";import{V as se}from"./VSnackbar-DLsie24e.js";import{V as j}from"./VContainer-_thcESsg.js";import{a as A,V as E}from"./VRow-BUCwKPdE.js";import{V as ae}from"./VCard-CYTY4Ak6.js";import{V as oe}from"./VAvatar-CniIBmDG.js";import"./index-BBnWEKBt.js";import"./VForm-vE2Z0sYY.js";import"./VList-gv0WSxHA.js";const le="/assets/mp-logo-CD8ZY2hp.png",ne={class:"mp-form-asistencia"},re={class:"d-flex align-center"},ie={class:"text-white m-0"},ue={__name:"AsistenciaMujerProduceForm",setup(B){const b=J(),_=f(!1),u=V({}),v=F(),d=K(),t=f(!1),S=f(1),e=V({}),c=f({show:!1,message:"",color:"",icon:""});k("formState",e),k("loadingStates",u),k("loadingSubmit",t);const m=V([{type:"select",label:"Tipo de documento",model:"typedocument_id",required:!0,options:[]},{type:"search",label:"Número de Documento",model:"documentnumber",required:!0,max:8,disabled:!1},{type:"search",label:"Número de RUC",model:"ruc",required:!0,max:11,disabled:!1}]);Q(_,a=>{b.global.name.value=a?"dark":"light"});const M=a=>{const l=m.find(r=>r.model===a);S.value==1&&a=="ruc"&&(l.disabled=!l.disabled,P()),a=="documentnumber"&&C()},P=()=>{e.ruc=null,e.razonSocial=null,e.economicsector_id=null,e.rubro_id=null,e.comercialactivity_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.obs_ruc=null},C=()=>{e.typedocument_id=null,e.documentnumber=null,e.name=null,e.lastname=null,e.middlename=null,e.country_id=null,e.birthday=null,e.gender_id=null,e.sick=null,e.academicdegree_id=null,e.civil_status_id=null,e.num_soons=0,e.role_company_id=null,e.obs_dni=null,e.phone=null,e.email=null},q=async(a,l)=>{if(a.model==="typedocument_id"){const r=m.find(x=>x.model==="documentnumber");if(!r)return;const y={1:{max:8,autolockNames:!0},2:{max:9,autolockNames:!1},3:{max:12,autolockNames:!1},default:{max:9,autolockNames:!1}},R=y[a.value]||y.default;r.max=R.max,a.value&&C(),["name","lastname","middlename"].forEach(x=>{const N=m.find(G=>G.model===x);N&&(N.disabled=R.autolockNames)}),r.disabled=!1}if(a.model==="documentnumber"){const r=m.find(y=>y.model==="documentnumber");r&&(r.disabled=!1)}},z=async a=>{if(a=="ruc")return O();if(a=="documentnumber")return H()},O=async()=>{},H=async()=>{},I=async()=>{t.value=!0;const a={ruc:e.ruc,doc_number:e.documentnumber,slug:v.params.slug,attendance:1};try{const l=await $({url:"mp/register-attendance",method:"POST",data:a});console.log("Response: ",l),l.status==200&&(e.documentnumber="",e.ruc="",c.value={show:!0,message:"Asistencia registrada correctamente.",color:"success",icon:"mdi-check-circle"}),l.status==409&&(c.value={show:!0,message:"Ya te has registrado.",color:"warning",icon:"mdi-alert-circle"}),l.status==404&&d.push({path:`/mujer-produce/${v.params.slug}`,query:{status:201,mensaje:"registrar-empresario",ruc:e.ruc}})}catch(l){console.log("Error: ",l)}finally{t.value=!1}},{loadTypeDocuments:U}=Z(m);return T(async()=>{await U(),e.typedocument_id=1}),(a,l)=>(h(),w("div",ne,[s(Y,{colorForm:"#d41a75",fields:m,onSearchDataApi:z,onSubmit:I,onChange:q,onHandleClearSearch:M},null,8,["fields"]),s(se,{modelValue:c.value.show,"onUpdate:modelValue":l[0]||(l[0]=r=>c.value.show=r),color:c.value.color,timeout:"6000",location:"top right",rounded:"lg",elevation:"4",class:"d-flex align-center"},{default:o(()=>[n("div",re,[s(g,{class:"mr-3",size:"28"},{default:o(()=>[i(p(c.value.icon),1)]),_:1}),n("h3",ie,p(c.value.message),1)])]),_:1},8,["modelValue","color"])]))}},de={class:"mp-header mp"},ce={style:{"line-height":"2.2",color:"#fff"}},me={class:"title",style:{"line-height":"1.3"}},fe={style:{"list-style":"none","padding-left":"0","font-size":"18px"}},pe={key:0,class:"mp"},_e={key:1},he={class:"text-center",style:{"max-width":"380px"}},Ae={__name:"[slug]",setup(B){L("Mujer Produce | Registro","Formulario de registro para el Evento de Producción de Mujeres","mp-ico.ico");const b=F(),_=f(!0),u=f({}),v=async()=>{try{const d=b.params.slug,t=await $({url:`mp/info-event-public/${d}`,method:"GET"});t.status===200&&(u.value=(t==null?void 0:t.data)||{}),console.log("response",t)}catch(d){console.error("Error de red:",d)}finally{_.value=!1}};return T(async()=>{await v()}),(d,t)=>(h(),D(j,{class:"py-0",fluid:""},{default:o(()=>[s(A,{align:"center",justify:"center"},{default:o(()=>[s(E,{cols:"12",sm:"12",md:"10",lg:"8",xl:"5",class:"my-2"},{default:o(()=>[s(X,{"model-value":_.value,class:"align-center justify-center",persistent:"",scrim:""},{default:o(()=>[s(ee,{color:"#d41a75",size:"64",indeterminate:""})]),_:1},8,["model-value"]),_.value?W("",!0):(h(),D(ae,{key:0,elevation:"8",rounded:"lg",style:{"min-height":"96vh"}},{default:o(()=>[n("div",de,[s(A,null,{default:o(()=>[s(E,null,{default:o(()=>[n("div",ce,[s(oe,{width:100,src:le}),n("h1",me,p(u.value.title),1),n("ul",fe,[n("li",null,[s(g,null,{default:o(()=>t[1]||(t[1]=[i("mdi-map-marker")])),_:1,__:[1]}),i(" LUGAR: "+p(u.value.place),1)]),n("li",null,[s(g,{left:""},{default:o(()=>t[2]||(t[2]=[i("mdi-calendar")])),_:1,__:[2]}),i(" FECHA: "+p(u.value.date),1)]),n("li",null,[s(g,{left:""},{default:o(()=>t[3]||(t[3]=[i("mdi-clock-time-four-outline")])),_:1,__:[3]}),i(" HORARIO: "+p(u.value.hours),1)])])])]),_:1})]),_:1})]),u.value.finished?(h(),w("div",_e,[s(j,{class:"d-flex justify-center align-center",style:{"min-height":"50vh"}},{default:o(()=>[n("div",he,[s(g,{size:"70",color:"#d41a75",class:"mb-6"},{default:o(()=>t[5]||(t[5]=[i(" mdi-calendar-remove ")])),_:1,__:[5]}),t[7]||(t[7]=n("h2",{class:"text-h5 font-weight-medium mb-2"}," Inscripciones cerradas ",-1)),t[8]||(t[8]=n("p",{class:"text-body-2 text-medium-emphasis mb-6"}," Este evento ya no acepta nuevas inscripciones. Te invitamos a revisar otras actividades disponibles. ",-1)),s(te,{color:"#d41a75",variant:"text",class:"text-none",onClick:t[0]||(t[0]=S=>d.$emit("go-to-events"))},{default:o(()=>t[6]||(t[6]=[i(" Ver próximos eventos ")])),_:1,__:[6]})])]),_:1})])):(h(),w("div",pe,[t[4]||(t[4]=n("h1",{class:"mb-8"},"Asistencia",-1)),s(ue)]))]),_:1}))]),_:1})]),_:1})]),_:1}))}};export{Ae as default};
