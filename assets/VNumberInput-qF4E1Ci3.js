import{M as ee,N as fe,O as pe,r as ge,aZ as be,v as h,s as G,Q as Ne,ag as we,aP as A,k as Z,E as M,o as he,S as xe,x as ne,d as x,e as g,F as L,z as Pe,B as te,ac as ae,aB as De,aC as Ve,a_ as Ie,D as $,a$ as Se,b0 as Fe}from"./index-DY34Kbf3.js";import{e as _}from"./VList-F2UT2m_Z.js";const ye=50,Ee=500;function Ce(n){let{toggleUpDown:z}=n,a=-1,w=-1;ee(s);function E(r){s(),V(r),window.addEventListener("pointerup",s),document.addEventListener("blur",s),a=window.setTimeout(()=>{w=window.setInterval(()=>V(r),ye)},Ee)}function s(){window.clearTimeout(a),window.clearInterval(w),window.removeEventListener("pointerup",s),document.removeEventListener("blur",s)}ee(s);function V(r){z(r==="up")}return{holdStart:E,holdStop:s}}const Te=pe({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},minFractionDigits:{type:Number,default:null},decimalSeparator:{type:String,validator:n=>!n||n.length===1},...Ve(Ie(),["modelValue","validationValue"])},"VNumberInput"),Be=fe()({name:"VNumberInput",props:{...Te()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,z){let{slots:a}=z;const w=ge(),{holdStart:E,holdStop:s}=Ce({toggleUpDown:H}),V=be(n),r=h(()=>V.isDisabled.value||V.isReadonly.value),C=G(n.focused),{decimalSeparator:ue}=Ne(),l=h(()=>{var e;return((e=n.decimalSeparator)==null?void 0:e[0])||ue.value});function P(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.precision,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const v=t==null?String(e):e.toFixed(t);if(C.value&&d)return Number(v).toString().replace(".",l.value);if(n.minFractionDigits===null||t!==null&&t<n.minFractionDigits)return v.replace(".",l.value);let[D,c]=v.split(".");return c=(c??"").padEnd(n.minFractionDigits,"0").replace(new RegExp(`(?<=\\d{${n.minFractionDigits}})0+$`,"g"),""),[D,c].filter(Boolean).join(l.value)}const u=we(n,"modelValue",null,e=>e??null,e=>e==null?e??null:A(Number(e),n.min,n.max)),b=G(null),I=G(null);Z(u,e=>{var t;C.value&&!r.value&&Number((t=b.value)==null?void 0:t.replace(l.value,"."))===e||(e==null?(b.value=null,I.value=null):isNaN(e)||(b.value=P(e),I.value=Number(b.value.replace(l.value,"."))))},{immediate:!0});const i=h({get:()=>b.value,set(e){if(e===null||e===""){u.value=null,b.value=null,I.value=null;return}const t=Number(e.replace(l.value,"."));isNaN(t)||(b.value=e,I.value=t,t<=n.max&&t>=n.min&&(u.value=t))}}),le=h(()=>{var t;if(I.value===null)return!1;const e=Number((t=b.value)==null?void 0:t.replace(l.value,"."));return e!==A(e,n.min,n.max)}),O=h(()=>r.value?!1:(u.value??0)+n.step<=n.max),U=h(()=>r.value?!1:(u.value??0)-n.step>=n.min),o=h(()=>n.hideInput?"stacked":n.controlVariant),j=M(()=>o.value==="split"?"$plus":"$collapse"),Q=M(()=>o.value==="split"?"$minus":"$expand"),T=M(()=>o.value==="split"?"default":"small"),k=M(()=>o.value==="stacked"?"auto":"100%"),ie={props:{onClick:R,onPointerup:N,onPointerdown:X,onPointercancel:N}},re={props:{onClick:R,onPointerup:N,onPointerdown:Y,onPointercancel:N}};Z(()=>n.precision,()=>q()),Z(()=>n.minFractionDigits,()=>q()),he(()=>{K()});function W(e){if(e==null)return 0;const t=e.toString(),d=t.indexOf(".");return~d?t.length-d:0}function H(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(r.value)return;if(u.value==null){i.value=P(A(0,n.min,n.max));return}let t=Math.max(W(u.value),W(n.step));n.precision!=null&&(t=Math.max(t,n.precision)),e?O.value&&(i.value=P(u.value+n.step,t)):U.value&&(i.value=P(u.value-n.step,t))}function oe(e){var S;if(!e.data)return;const t=e.target,{value:d,selectionStart:v,selectionEnd:D}=t??{},c=d?d.slice(0,v)+e.data+d.slice(D):e.data,m=Se(c,n.precision,l.value);if(new RegExp(`^-?\\d*${Fe(l.value)}?\\d*$`).test(c)||(e.preventDefault(),t.value=m,$(()=>i.value=m)),n.precision!=null){if(((S=c.split(l.value)[1])==null?void 0:S.length)>n.precision){e.preventDefault(),t.value=m,$(()=>i.value=m);const B=(v??0)+e.data.length;t.setSelectionRange(B,B)}n.precision===0&&c.endsWith(l.value)&&(e.preventDefault(),t.value=m,$(()=>i.value=m))}}async function ce(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),K(),await $(),e.key==="ArrowDown"?H(!1):H())}function R(e){e.stopPropagation()}function N(e){const t=e.currentTarget;t==null||t.releasePointerCapture(e.pointerId),e.preventDefault(),s()}function X(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),E("up")}function Y(e){const t=e.currentTarget;t==null||t.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),E("down")}function K(){if(r.value||!w.value)return;const e=w.value.value,t=Number(e.replace(l.value,"."));e&&!isNaN(t)?i.value=P(A(t,n.min,n.max)):i.value=null}function q(){r.value||(i.value=u.value!==null&&!isNaN(u.value)?P(u.value,n.precision,!1):null)}function se(){if(!r.value){if(u.value===null||isNaN(u.value)){i.value=null;return}i.value=u.value.toString().replace(".",l.value)}}function de(){se()}function ve(){K()}return xe(()=>{const{modelValue:e,type:t,...d}=ne.filterProps(n);function v(){return a.increment?g(ae,{key:"increment-defaults",defaults:{VBtn:{disabled:!O.value,height:k.value,size:T.value,icon:j.value,variant:"text"}}},{default:()=>[a.increment(ie)]}):g(te,{"aria-hidden":"true","data-testid":"increment",disabled:!O.value,height:k.value,icon:j.value,key:"increment-btn",onClick:R,onPointerdown:X,onPointerup:N,onPointercancel:N,size:T.value,variant:"text",tabindex:"-1"},null)}function D(){return a.decrement?g(ae,{key:"decrement-defaults",defaults:{VBtn:{disabled:!U.value,height:k.value,size:T.value,icon:Q.value,variant:"text"}}},{default:()=>[a.decrement(re)]}):g(te,{"aria-hidden":"true","data-testid":"decrement",disabled:!U.value,height:k.value,icon:Q.value,key:"decrement-btn",onClick:R,onPointerdown:Y,onPointerup:N,onPointercancel:N,size:T.value,variant:"text",tabindex:"-1"},null)}function c(){return x("div",{class:"v-number-input__control"},[D(),g(_,{vertical:o.value!=="stacked"},null),v()])}function m(){return!n.hideInput&&!n.inset?g(_,{vertical:!0},null):void 0}const S=o.value==="split"?x("div",{class:"v-number-input__control"},[g(_,{vertical:!0},null),v()]):n.reverse||o.value==="hidden"?void 0:x(L,null,[m(),c()]),B=a["append-inner"]||S,J=o.value==="split"?x("div",{class:"v-number-input__control"},[D(),g(_,{vertical:!0},null)]):n.reverse&&o.value!=="hidden"?x(L,null,[c(),m()]):void 0,me=a["prepend-inner"]||J;return g(ne,Pe({ref:w},d,{modelValue:i.value,"onUpdate:modelValue":f=>i.value=f,focused:C.value,"onUpdate:focused":f=>C.value=f,validationValue:u.value,error:n.error||le.value||void 0,onBeforeinput:oe,onFocus:de,onBlur:ve,onKeydown:ce,class:["v-number-input",{"v-number-input--default":o.value==="default","v-number-input--hide-input":n.hideInput,"v-number-input--inset":n.inset,"v-number-input--reverse":n.reverse,"v-number-input--split":o.value==="split","v-number-input--stacked":o.value==="stacked"},n.class],style:n.style,inputmode:"decimal"}),{...a,"append-inner":B?function(){var y;for(var f=arguments.length,F=new Array(f),p=0;p<f;p++)F[p]=arguments[p];return x(L,null,[(y=a["append-inner"])==null?void 0:y.call(a,...F),S])}:void 0,"prepend-inner":me?function(){var y;for(var f=arguments.length,F=new Array(f),p=0;p<f;p++)F[p]=arguments[p];return x(L,null,[J,(y=a["prepend-inner"])==null?void 0:y.call(a,...F)])}:void 0})}),De({},w)}});export{Be as V};
