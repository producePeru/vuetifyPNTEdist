import{u as Z}from"./usePageMeta-DrengYLM.js";import{h as y}from"./httpRequest-D3KC4pOG.js";import{B as ee}from"./Banner-DNtErvPs.js";import{_ as te}from"./FormComponent-Dcm0LLMd.js";import{u as ae}from"./useFormOptions-BD_ZbAMu.js";import{L as ie,r as h,i as D,u as R,k as oe,H as re,o as N,c as w,b as u,e as m,M as q,_ as le,h as de,d as b,f as S,m as V,w as p,g as k,y as M,V as ne,F as se,j as ce,l as me}from"./index-BqCTMh8N.js";import{d as v}from"./VDialog-Cu9Wq3Ao.js";import{_ as ue}from"./Finalizado-B7_WkV3r.js";import{V as pe}from"./VSnackbar-Be0KF62n.js";import{V as _e}from"./VContainer-Dfede9z0.js";import{a as fe,V as be}from"./VRow-CRajriFl.js";import{V as ye}from"./VCard-daO-PNYP.js";import"./mp-D70lmokk.js";import"./es-DRpT6ha1.js";import"./VAvatar-cemYZ-d8.js";import"./index-DXZz9Q6I.js";import"./VForm-CshbwNnl.js";import"./VList-XTiBcIky.js";const ve={class:"mp-form"},he={__name:"MujerProduceForm",emits:["registered"],setup(Y,{emit:c}){const g=c,_=ie(),f=h(!1),i=D({}),o=R();oe();const l=h(!1),n=h(1),e=D({num_soons:0,obs_ruc:null,obs_dni:null,ruc:o.query.ruc||null});q("formState",e),q("loadingStates",i),q("loadingSubmit",l);const s=D([{type:"title",label:"Datos de la Empresa",md:12},{type:"search",label:"Número de RUC",model:"ruc",required:!1,max:11,disabled:!1},{type:"text",label:"Razón Social",model:"razonSocial",required:!1,disabled:!0},{type:"select",label:"Sector Económico",model:"economicsector_id",required:!0,options:[],disabled:!1},{type:"select",label:"Rubro",model:"rubro_id",required:!0,options:[],disabled:!1},{type:"select",label:"Actividad Comercial",model:"comercialactivity_id",required:!0,options:[],disabled:!1},{type:"select",label:"Región",model:"city_id",required:!0,options:[],disabled:!1},{type:"select",label:"Provincia",model:"province_id",required:!0,options:[],disabled:!1},{type:"select",label:"Distrito",model:"district_id",required:!0,options:[],disabled:!1},{type:"title",label:"Datos del Participante",md:12},{type:"select",label:"Tipo de documento",model:"typedocument_id",required:!0,options:[]},{type:"search",label:"Número de Documento",model:"documentnumber",required:!0,max:8,disabled:!1},{type:"text",label:"Apellido Paterno",model:"lastname",required:!0,disabled:!0},{type:"text",label:"Apellido Materno",model:"middlename",required:!0,disabled:!0},{type:"text",label:"Nombres",model:"name",required:!0,disabled:!0},{type:"select",label:"País de nacimiento",model:"country_id",required:!0,options:[]},{type:"date",label:"Fecha de nacimiento",model:"birthday",required:!0},{type:"select",label:"Género",model:"gender_id",required:!0,options:[]},{type:"select",label:"¿Tiene alguna discapacidad?",model:"sick",required:!0,options:[{label:"SI",value:"si"},{label:"NO",value:"no"}]},{type:"select",label:"Nivel educativo",model:"academicdegree_id",required:!0,options:[]},{type:"select",label:"Estado civil",model:"civil_status_id",required:!0,options:[]},{type:"number",label:"Cantidad de hijos",model:"num_soons",required:!0,max:3,minLength:0},{type:"number",label:"Número de celular",model:"phone",required:!0,max:9,minLength:9},{type:"email",label:"Correo electrónico",model:"email",required:!0},{type:"select",label:"Cargo en la empresa",model:"role_company_id",required:!0,options:[]},{type:"checkbox",label:'Autorizo la participación y el uso de mis datos personales e imagen para fines institucionales del Programa Nacional "Tu Empresa", según la Ley N.º 29733',model:"autorization",required:!0,md:12,rows:3}]);re(f,a=>{_.global.name.value=a?"dark":"light"});const P=a=>{const t=s.find(r=>r.model===a);n.value==1&&a=="ruc"&&(t.disabled=!t.disabled,H()),a=="documentnumber"&&C()},H=()=>{e.ruc=null,e.razonSocial=null,e.economicsector_id=null,e.rubro_id=null,e.comercialactivity_id=null,e.city_id=null,e.province_id=null,e.district_id=null,e.obs_ruc=null},C=()=>{e.typedocument_id=null,e.documentnumber=null,e.name=null,e.lastname=null,e.middlename=null,e.birthday=null,e.gender_id=null,e.sick=null,e.academicdegree_id=null,e.civil_status_id=null,e.num_soons=0,e.role_company_id=null,e.obs_dni=null,e.phone=null,e.email=null},A=async(a,t)=>{if(a.model=="rubro_id"){e.comercialactivity_id=null;const r=await y({url:`select/activity-by-rubro/${a.value}`,method:"GET"}),d=s.find(x=>x.model==="comercialactivity_id");d.options=r.data}if(a.model=="city_id"){e.province_id=null,e.district_id=null;const r=`select/provinces/${a.value}`;E(r,"province_id")}if(a.model=="province_id"){e.district_id=null;const r=`select/districts/${a.value}`;E(r,"district_id")}if(a.model==="typedocument_id"){const r=s.find($=>$.model==="documentnumber");if(!r)return;const d={1:{max:8,autolockNames:!0},2:{max:9,autolockNames:!1},3:{max:12,autolockNames:!1},default:{max:9,autolockNames:!1}},x=d[a.value]||d.default;r.max=x.max,a.value&&C(),["name","lastname","middlename"].forEach($=>{const T=s.find(X=>X.model===$);T&&(T.disabled=x.autolockNames)}),r.disabled=!1}if(a.model==="documentnumber"){const r=s.find(d=>d.model==="documentnumber");r&&(r.disabled=!1)}},F=async a=>{if(a=="ruc")return z();if(a=="documentnumber")return j()},z=async()=>{try{const a=await y({url:`mp/ruc-number/${e.ruc}`,method:"POST"});if(a.status==409&&["razonSocial"].forEach(t=>{const r=s.find(d=>d.model===t);r&&(r.disabled=!1),e.obs_ruc=1}),a.status==200){const{data:t}=a;e.razonSocial=t.social_reason,e.economicsector_id=t.economic_sector_id,e.rubro_id=t.rubro_id,await E(`select/activity-by-rubro/${t.rubro_id}`,"comercialactivity_id"),e.comercialactivity_id=t.comercial_activity_id,e.city_id=t.city_id,await E(`select/provinces/${t.city_id}`,"province_id"),e.province_id=t.province_id,await E(`select/districts/${t.province_id}`,"district_id"),e.district_id=t.district_id}i.ruc=!1}catch(a){console.log("Error: ",a)}},j=async()=>{try{const a=await y({url:`mp/dni-number/${e.documentnumber}`,method:"POST"});if(a.status==409&&["documentnumber","name","lastname","middlename"].forEach(t=>{const r=s.find(d=>d.model===t);r&&(r.disabled=!1),e.obs_dni=1}),a.status==201){const{data:t}=a;e.lastname=t.last_name,e.middlename=t.middle_name,e.name=t.names}if(a.status==200){const{data:t}=a;e.name=t.names,e.lastname=t.last_name,e.middlename=t.middle_name,e.gender_id=t.gender_id,e.sick=t.sick,e.academicdegree_id=t.academicdegree_id,e.civil_status_id=t.civil_status_id,e.num_soons=t.num_soons,e.birthday=v(t.date_of_birth).format("DD/MM/YYYY"),e.phone=t.phone,e.email=t.email,e.role_company_id=t.role_company_id,e.country_id=t.country_id}i.documentnumber=!1}catch(a){console.log("Error: ",a)}},I=async()=>{l.value=!0;const a={ruc:e.ruc,social_reason:e.razonSocial,economic_sector_id:e.economicsector_id,rubro_id:e.rubro_id,comercial_activity_id:e.comercialactivity_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,t_doc_id:e.typedocument_id,doc_number:e.documentnumber,country_id:e.country_id,date_of_birth:e.birthday,names:e.name,last_name:e.lastname,middle_name:e.middlename,civil_status_id:e.civil_status_id,num_soons:e.num_soons,gender_id:e.gender_id,sick:e.sick,academicdegree_id:e.academicdegree_id,phone:e.phone,email:e.email,role_company_id:e.role_company_id,obs_ruc:e.obs_ruc,obs_dni:e.obs_dni,slug:o.params.slug};try{const t=await y({url:"mp/register-participant",method:"POST",data:a});if(t.status==200){if(o.query.ruc){const r={ruc:e.ruc,doc_number:e.documentnumber,slug:o.params.slug,attendance:1},d=await y({url:"mp/register-attendance",method:"POST",data:r})}setTimeout(()=>{g("registered",t)},700)}}catch(t){console.log("Error: ",t)}finally{l.value=!1}},E=async(a,t)=>{try{const r=await y({url:a,method:"GET"}),d=s.find(x=>x.model===t);d&&r.data&&(d.options=r.data)}catch(r){console.error("Error de red:",r)}},{loadSectorEconomico:B,loadRubros:O,loadCountries:G,loadCity:L,loadTypeDocuments:U,loadGenders:W,loadCivilStatus:J,loadAcademicDegree:K,loadRoleCompany:Q}=ae(s);return N(async()=>{await B(),await O(),await L(),await U(),await W(),await J(),await G(),await K(),await Q(),e.country_id=155}),(a,t)=>(u(),w("div",ve,[m(te,{colorForm:"#7d4fc6",fields:s,onSearchDataApi:F,onSubmit:I,onChange:A,onHandleClearSearch:P},null,8,["fields"])]))}},ge={class:"d-flex justify-center align-center"},xe={class:"text-center pa-8",style:{"max-width":"420px",width:"100%"}},ke={class:"text-center"},Ee={class:"d-flex flex-column align-center text-center"},we={__name:"Sala",props:{detailEvent:{type:Object,default:()=>({})}},setup(Y){const c=Y,g=h(!0),_=de(()=>{const i=c.detailEvent;if(!(i!=null&&i.title)||!(i!=null&&i.date)||!(i!=null&&i.hourStart)||!(i!=null&&i.hourEnd))return null;const o=v(`${i.date} ${i.hourStart}`,"DD/MM/YYYY HH:mm:ss"),l=v(`${i.date} ${i.hourEnd}`,"DD/MM/YYYY HH:mm:ss");if(!o.isValid()||!l.isValid())return null;const n=o.format("YYYYMMDDTHHmmss"),e=l.format("YYYYMMDDTHHmmss"),s=`
    Capacitación ${i.modality}.
    Este es el link de la sala de la capacitación:
    ${i.link}
      `.trim();return`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(i.title)}&dates=${n}/${e}&details=${encodeURIComponent(s)}&location=${encodeURIComponent(i.modality==="VIRTUAL"?"Evento Virtual":i.place??"")}`}),f=()=>{const i=v(),o=v(c.detailEvent.date,"DD/MM/YYYY");if(!i.isSame(o,"day"))return!1;const l=v(`${c.detailEvent.date} ${c.detailEvent.hourStart}`,"DD/MM/YYYY HH:mm:ss"),n=v(`${c.detailEvent.date} ${c.detailEvent.hourEnd}`,"DD/MM/YYYY HH:mm:ss");return i.isAfter(l)&&i.isBefore(n)};return(i,o)=>(u(),w(se,null,[b("div",ge,[b("div",xe,[o[4]||(o[4]=b("p",{class:"mb-6",style:{color:"#7d4fc6"}}," Ya estás registrado. Únete al grupo para recibir avisos e información importante. ",-1)),m(M,{color:"success",size:"large",rounded:"pill",class:"text-none font-weight-medium mb-8",block:"","prepend-icon":"mdi-whatsapp",href:"https://api.whatsapp.com/send?phone=+51989540907&text=Hola,%20comunidad%20Mujer%20Produce",target:"_blank"},{default:p(()=>o[1]||(o[1]=[k(" Unirme al grupo de WhatsApp ")])),_:1,__:[1]}),f()?(u(),S(M,{key:0,color:"#7d4fc6",size:"large",rounded:"pill",class:"text-none font-weight-medium mb-8",block:"","prepend-icon":"mdi-video",href:Y.detailEvent.link,target:"_blank"},{default:p(()=>o[2]||(o[2]=[k(" Ingresar a la sala virtual ")])),_:1,__:[2]},8,["href"])):V("",!0),_.value?(u(),S(M,{key:1,color:"#fbc311",size:"large",rounded:"pill",class:"text-none font-weight-medium mb-3",block:"","prepend-icon":"mdi-calendar-plus",href:_.value,target:"_blank"},{default:p(()=>o[3]||(o[3]=[k(" Agendar en Google Calendar ")])),_:1,__:[3]},8,["href"])):V("",!0)])]),b("div",ke,[m(pe,{modelValue:g.value,"onUpdate:modelValue":o[0]||(o[0]=l=>g.value=l),location:"top right",vertical:"",color:"white",class:"pa-4",timeout:12e3},{default:p(()=>[b("div",Ee,[m(ne,{size:"80",color:"success",class:"mb-4"},{default:p(()=>o[5]||(o[5]=[k(" mdi-check-circle-outline ")])),_:1,__:[5]}),o[6]||(o[6]=b("h2",{class:"text-h5 font-weight-semibold mb-2"}," ¡Registro confirmado! ",-1)),o[7]||(o[7]=b("p",{class:"text-body-1 text-medium-emphasis mb-6"},[k(" Gracias por registrarte a este evento."),b("br"),k(" Te esperamos en el evento. ")],-1))])]),_:1},8,["modelValue"])])],64))}},Se=le(we,[["__scopeId","data-v-1a8217b9"]]),Ye={key:0,class:"mp",style:{"min-height":"calc(100vh - 390px)"}},$e={key:1,class:"text-center"},De={key:1},Ue={__name:"[slug]",setup(Y){Z("Mujer Produce | Registro","Formulario de registro para el Evento de Producción de Mujeres","mp-ico.ico");const c=h(!0),g=R(),_=h(!0),f=h({}),i=l=>{l&&(c.value=!1)},o=async()=>{try{const l=g.params.slug,n=await y({url:`mp/info-event-public/${l}`,method:"GET"});n.status===200&&(f.value=(n==null?void 0:n.data)||{}),console.log("response",n)}catch(l){console.error("Error de red:",l)}finally{_.value=!1}};return N(async()=>{await o()}),(l,n)=>(u(),S(_e,{class:"py-0",fluid:""},{default:p(()=>[m(fe,{align:"center",justify:"center"},{default:p(()=>[m(be,{cols:"12",sm:"12",md:"10",lg:"8",xl:"6",class:"my-2"},{default:p(()=>[m(ce,{"model-value":_.value,class:"align-center justify-center",persistent:"",scrim:""},{default:p(()=>[m(me,{color:"#7d4fc6",size:"64",indeterminate:""})]),_:1},8,["model-value"]),_.value?V("",!0):(u(),S(ye,{key:0,elevation:"8",rounded:"lg"},{default:p(()=>[m(ee,{detailEvent:f.value},null,8,["detailEvent"]),f.value.finished?(u(),w("div",De,[m(ue)])):(u(),w("div",Ye,[c.value?(u(),S(he,{key:0,onRegistered:i})):(u(),w("div",$e,[m(Se,{detailEvent:f.value},null,8,["detailEvent"])]))]))]),_:1}))]),_:1})]),_:1})]),_:1}))}};export{Ue as default};
