import{u as ae}from"./usePageMeta-DgSkwlnp.js";import{d as V}from"./dayjs.min-BaPeHrhp.js";import{c as oe}from"./customParseFormat-BHeJVP8q.js";import"./es-nefKSrI6.js";import{_ as le,c as T,b as w,d as p,e as l,w as c,t as f,g as y,V as x,r as b,u as de,h as k,i as z,j as re,o as P,k as se,p as C,f as A,l as ne,m as ce,n as me}from"./index-CdUwQdOV.js";import{V as O,a as F}from"./VRow-CfpktdI2.js";import{_ as ue}from"./FormComponent-kdSwMKLB.js";import{u as _e}from"./useFormOptions-BD_ZbAMu.js";import{h as S}from"./httpRequest-D3KC4pOG.js";import{V as pe}from"./VSnackbar-DKm22VIz.js";import{V as fe}from"./VContainer-DbRY79T4.js";import{V as ye}from"./VCard-CblntBVB.js";import"./index-b688TP73.js";import"./VAutocomplete-CzxxYRIg.js";import"./VList-dHy-I1ng.js";import"./VAvatar-yHTdl7Ia.js";import"./VDialog-rz9SlHWG.js";import"./VForm-CurYl2Hy.js";const be={class:"mp-header mp"},ve={style:{"line-height":"2.2",color:"#fff",position:"relative","z-index":"2"}},he={class:"mp-title"},ge={style:{"list-style":"none","padding-left":"0","font-size":"18px"}},Se={class:"mp-list"},Ee={class:"mp-list"},xe={class:"mp-list"},we={__name:"ActividadesUgo",props:{detailEvent:{type:Object,default:()=>({})}},setup(u){return V.extend(oe),(v,d)=>(w(),T("div",be,[d[3]||(d[3]=p("div",{class:"mp-header-back"},null,-1)),l(F,null,{default:c(()=>[l(O,null,{default:c(()=>{var h,_,m;return[p("div",ve,[p("h1",he,f(u.detailEvent.title),1),p("ul",ge,[p("li",Se,[l(x,null,{default:c(()=>d[0]||(d[0]=[y("mdi-tag")])),_:1,__:[0]}),y(" TEMA: "+f(u.detailEvent.theme),1)]),p("li",Ee,[l(x,{left:""},{default:c(()=>d[1]||(d[1]=[y("mdi-calendar")])),_:1,__:[1]}),y(" FECHA: "+f(u.detailEvent.startDate)+" - "+f(u.detailEvent.endDate),1)]),p("li",xe,[l(x,{left:""},{default:c(()=>d[2]||(d[2]=[y("mdi-account-tie")])),_:1,__:[2]}),y(" RESPONSABLE: "+f((h=u.detailEvent.asesor)==null?void 0:h.name)+" "+f((_=u.detailEvent.asesor)==null?void 0:_.lastname)+" "+f((m=u.detailEvent.asesor)==null?void 0:m.middlename),1)])])])]}),_:1})]),_:1})]))}},Ne=le(we,[["__scopeId","data-v-c2b33f16"]]),Re={class:"mp-form"},ke={__name:"FormAsistenciaUgo",emits:["loaded","registered"],setup(u,{emit:v}){const d=v,h=b(null),_=b(!1);de(),b(!1);const m=k({}),s=z();re();const E=b(!1),M=b(1),e=k({num_soons:0,obs_ruc:null,obs_dni:null,ruc:null});C("formState",e),C("loadingStates",m),C("loadingSubmit",E);const r=k([{type:"title",label:"Datos de la Empresa",md:12},{type:"search",label:"Número de RUC",model:"ruc",required:!1,max:11,disabled:!1},{type:"text",label:"Razón Social",model:"razonSocial",required:!1,disabled:!1},{type:"text",label:"Nombre Comercial (marca)",model:"comercialName",required:!1},{type:"select",label:"Sector Económico",model:"economicsector_id",required:!0,options:[],disabled:!1},{type:"select",label:"Rubro",model:"rubro_id",required:!0,options:[],disabled:!1},{type:"select",label:"Actividad Comercial",model:"comercialactivity_id",required:!1,options:[],disabled:!1},{type:"select",label:"Región",model:"city_id",required:!0,options:[],disabled:!1},{type:"select",label:"Provincia",model:"province_id",required:!0,options:[],disabled:!1},{type:"select",label:"Distrito",model:"district_id",required:!0,options:[],disabled:!1},{type:"title",label:"Datos del Participante",md:12},{type:"select",label:"Tipo de documento",model:"typedocument_id",required:!0,options:[]},{type:"search",label:"Número de Documento",model:"documentnumber",required:!0,max:8,disabled:!1},{type:"text",label:"Apellido Paterno",model:"lastname",required:!0,disabled:!0},{type:"text",label:"Apellido Materno",model:"middlename",required:!0,disabled:!0},{type:"text",label:"Nombres",model:"name",required:!0,disabled:!0},{type:"select",label:"Género",model:"gender_id",required:!0,options:[]},{type:"select",label:"¿Tiene alguna discapacidad?",model:"sick",required:!0,options:[{label:"SI",value:"si"},{label:"NO",value:"no"}]},{type:"email",label:"Correo electrónico",model:"email",required:!0},{type:"number",label:"Número de celular",model:"phone",required:!0,max:9,minLength:9},{type:"select",label:"País de nacimiento",model:"country_id",required:!0,options:[]}]),Y=i=>{const t=r.find(a=>a.model===i);M.value==1&&i=="ruc"&&(t.disabled=!t.disabled,q()),i=="documentnumber"&&N()},q=()=>{e.ruc=null,e.razonSocial=null,e.comercialName=null,e.economicsector_id=null,e.rubro_id=null,e.comercialactivity_id=null,e.city_id=null,e.province_id=null,e.district_id=null},N=()=>{e.typedocument_id=null,e.documentnumber=null,e.name=null,e.lastname=null,e.middlename=null,e.gender_id=null,e.sick=null,e.phone=null,e.email=null,e.country_id=null},j=async(i,t)=>{if(i.model=="rubro_id"){e.comercialactivity_id=null;const a=await S({url:`select/activity-by-rubro/${i.value}`,method:"GET"}),o=r.find(n=>n.model==="comercialactivity_id");o.options=a.data}if(i.model=="city_id"){e.province_id=null,e.district_id=null;const a=`select/provinces/${i.value}`;g(a,"province_id")}if(i.model=="province_id"){e.district_id=null;const a=`select/districts/${i.value}`;g(a,"district_id")}if(i.model==="typedocument_id"){const a=r.find(R=>R.model==="documentnumber");if(!a)return;const o={1:{max:8,autolockNames:!0},2:{max:9,autolockNames:!1},3:{max:12,autolockNames:!1},default:{max:9,autolockNames:!1}},n=o[i.value]||o.default;a.max=n.max,i.value&&N(),["name","lastname","middlename"].forEach(R=>{const $=r.find(ie=>ie.model===R);$&&($.disabled=n.autolockNames)}),a.disabled=!1}if(i.model==="documentnumber"){const a=r.find(o=>o.model==="documentnumber");a&&(a.disabled=!1)}},B=async i=>{if(i=="ruc")return G();if(i=="documentnumber")return U()},G=async()=>{try{const i=await S({url:`mp/ruc-number/${e.ruc}`,method:"POST"});if(i.status==409&&["razonSocial"].forEach(t=>{const a=r.find(o=>o.model===t);a&&(a.disabled=!1),e.obs_ruc=1}),i.status==200){const{data:t}=i;e.razonSocial=t.social_reason,e.economicsector_id=t.economic_sector_id,e.rubro_id=t.rubro_id,await g(`select/activity-by-rubro/${t.rubro_id}`,"comercialactivity_id"),e.comercialactivity_id=t.comercial_activity_id,e.city_id=t.city_id,await g(`select/provinces/${t.city_id}`,"province_id"),e.province_id=t.province_id,await g(`select/districts/${t.province_id}`,"district_id"),e.district_id=t.district_id}m.ruc=!1}catch(i){console.log("Error: ",i)}},U=async()=>{try{const i=await S({url:`mp/dni-number/${e.documentnumber}`,method:"POST"});if(i.status==409&&["documentnumber","name","lastname","middlename"].forEach(t=>{const a=r.find(o=>o.model===t);a&&(a.disabled=!1),e.obs_dni=1}),i.status==201){const{data:t}=i;e.lastname=t.last_name,e.middlename=t.middle_name,e.name=t.names}if(i.status==200){const{data:t}=i;e.name=t.names,e.lastname=t.last_name,e.middlename=t.middle_name,e.gender_id=t.gender_id,e.sick=t.sick,e.academicdegree_id=t.academicdegree_id,e.civil_status_id=t.civil_status_id,e.num_soons=t.num_soons,e.birthday=V(t.date_of_birth).format("DD/MM/YYYY"),e.phone=t.phone,e.email=t.email,e.role_company_id=t.role_company_id,e.country_id=t.country_id}m.documentnumber=!1}catch(i){console.log("Error: ",i)}},I=async()=>{E.value=!0;const i={slug:s.params.slug,ruc:e.ruc,socialReason:e.razonSocial,comercialName:e.comercialName,economicsector_id:e.economicsector_id,category_id:e.rubro_id,comercialactivity_id:e.comercialactivity_id,city_id:e.city_id,province_id:e.province_id,district_id:e.district_id,typedocument_id:e.typedocument_id,documentnumber:e.documentnumber,lastname:e.lastname,middlename:e.middlename,name:e.name,gender_id:e.gender_id,sick:e.sick,email:e.email,phone:e.phone,country_id:e.country_id};try{const t=await S({url:"public/attendance-present",method:"POST",data:i});t.status==200&&(_.value=!0,h.value=t.message,q(),N())}catch(t){console.log("Error: ",t)}finally{E.value=!1}},D=i=>{Array.isArray(r)&&["razonSocial","lastname","middlename","name"].forEach(t=>{const a=r.find(o=>o.model===t);a&&(a.disabled=i)})},g=async(i,t)=>{try{const a=await S({url:i,method:"GET"}),o=r.find(n=>n.model===t);o&&a.data&&(o.options=a.data)}catch(a){console.error("Error de red:",a)}},L=async i=>{const t=await S({url:`select/activity-by-rubro/${i}`,method:"GET"}),a=r.find(o=>o.model==="comercialactivity_id");a.options=t.data},{loadSectorEconomico:H,loadRubros:K,loadCountries:J,loadCity:Q,loadTypeDocuments:W,loadGenders:X,loadCivilStatus:Z,loadAcademicDegree:ee,loadRoleCompany:te}=_e(r);return P(async()=>{await H(),await K(),await Q(),await W(),await X(),await Z(),await J(),await ee(),await te(),e.country_id=155}),se(()=>s.query,i=>{if(Object.keys(i).length){e.id=i.participant_id;const t={},a=["ruc","dni","phone"];Object.entries(i).forEach(([o,n])=>{n==="null"?t[o]=null:!a.includes(o)&&n!==""&&!isNaN(n)?t[o]=Number(n):t[o]=n}),e.ruc=t.ruc,e.razonSocial=t.socialReason,e.economicsector_id=t.economic_sector_id,e.rubro_id=t.rubro_id,L(t.rubro_id),e.comercialactivity_id=t.comercial_activity_id,e.city_id=t.city_id,g(`select/provinces/${t.city_id}`,"province_id"),e.province_id=t.province_id,g(`select/districts/${t.province_id}`,"district_id"),e.district_id=t.district_id,e.typedocument_id=t.t_doc_id,e.documentnumber=t.dni,e.lastname=t.last_name,e.middlename=t.middle_name,e.name=t.name,e.country_id=t.country_id,e.gender_id=t.gender_id,e.sick=t.sick,e.academicdegree_id=t.academicdegree_id,e.civil_status_id=t.civil_status_id,e.num_soons=t.numSoons,e.phone=t.phone,e.email=t.email,e.birthday=V(t.date_of_birth).format("DD/MM/YYYY"),e.role_company_id=t.role_company_id,setTimeout(()=>{d("loaded",!0)},2500),D(!1)}else D(!0)},{immediate:!0}),(i,t)=>(w(),T("div",Re,[l(ue,{colorForm:"#0f7eb3",fields:r,onSearchDataApi:B,onSubmit:I,nameBtnSend:"REGISTRAR",onChange:j,onHandleClearSearch:Y},null,8,["fields"]),l(pe,{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=a=>_.value=a),location:"top right",color:"success",timeout:"3000",elevation:"6"},{default:c(()=>[l(x,{start:""},{default:c(()=>t[1]||(t[1]=[y("mdi-check-circle")])),_:1,__:[1]}),y(" "+f(h.value),1)]),_:1},8,["modelValue"])]))}},Ce={class:"mp"},He={__name:"[slug]",setup(u){ae("Registro de actividades","Registro de actividades","pp.ico"),b(!0);const v=b(!0),d=b({}),h=z(),_=async()=>{try{const m=h.params.slug,s=await S({url:`public/data-attendance/${m}`,method:"GET"});console.log("response",s),s.status===200&&(d.value=(s==null?void 0:s.data)||{}),console.log("response",s)}catch(m){console.error("Error de red:",m)}finally{v.value=!1}};return P(async()=>{await _()}),(m,s)=>(w(),A(fe,{class:"py-0",fluid:""},{default:c(()=>[l(F,{align:"center",justify:"center"},{default:c(()=>[l(O,{cols:"12",sm:"12",md:"10",lg:"8",xl:"6",class:"my-2"},{default:c(()=>[l(ce,{"model-value":v.value,class:"align-center justify-center",persistent:"",scrim:""},{default:c(()=>[l(me,{color:"#0f7eb3",size:"64",indeterminate:""})]),_:1},8,["model-value"]),v.value?ne("",!0):(w(),A(ye,{key:0,elevation:"8",rounded:"lg"},{default:c(()=>[l(Ne,{detailEvent:d.value},null,8,["detailEvent"]),p("div",Ce,[l(ke,{onLoaded:s[0]||(s[0]=E=>v.value=!1)})])]),_:1}))]),_:1})]),_:1})]),_:1}))}};export{He as default};
